// Copyright (C) 2011-2012 Edward G Prentice
package net.egp.euler
import org.junit.runner.RunWith
import org.scalatest.junit.JUnitRunner
import org.scalatest.FunSuite

@RunWith(classOf[JUnitRunner])
class Euler extends FunSuite { // http://projecteuler.net/problems
  //val classManifest = scala.reflect.ClassManifest
  /**
   * **************************************************************************************************************
   * p1
   * Add all the natural numbers below one thousand that are multiples of 3 or 5.
   * published 2001.10.05, updated 2012.09.18, solved by 247384 people, solved by me=true
   * ***************************************************************************************************************
   * If we list all the natural numbers below 10 that are multiples of 3 or 5, we get 3, 5, 6 and 9. The sum of these multiples is 23.
   * Find the sum of all the multiples of 3 or 5 below 1000.
   */
  def p1(max: Int): Int = List.range(1, max).filter(x => (0 == x % 3) || (0 == x % 5)).foldLeft(0)(_ + _)
  test("P1.1000") { assert(p1(1000) === 233168) }
  /**
   * **************************************************************************************************************
   * p2
   * By considering the terms in the Fibonacci sequence whose values do not exceed four million, find the sum of the even-valued terms.
   * published 2001.10.19, updated 2012.09.18, solved by 203904 people, solved by me=true
   * ***************************************************************************************************************
   * Each new term in the Fibonacci sequence is generated by adding the previous two terms. By starting with 1 and 2, the first 10 terms will be:
   * 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ...
   * By considering the terms in the Fibonacci sequence whose values do not exceed four million, find the sum of the even-valued terms.
   */
  def p2(max: Int): Long = {
    def fib(max: Int, xs: List[Int]): List[Int] = {
      val next = xs.head + xs.tail.head
      if (next >= max) xs else fib(max, next :: xs)
    }
    fib(max, List(2, 1)).reverse.filter(x => (0 == x % 2)).foldLeft(0)(_ + _)
  }
  test("P2.4M") { assert(p2(4000000) === 4613732) }
  /**
   * **************************************************************************************************************
   * p3
   * Find the largest prime factor of a composite number.
   * published 2001.11.02, updated 2012.09.18, solved by 148316 people, solved by me=true
   * ***************************************************************************************************************
   * The prime factors of 13195 are 5, 7, 13 and 29.
   * What is the largest prime factor of the number 600851475143
   */
  def p3(goal: Long): Long = Primes.primesBelow(math.sqrt(goal).ceil.toInt + 1).filter(0 == goal % _).reverse.head
  test("P3.13195") { assert(p3(13195) === 29) } // 
  //test("P3.max") { assert(p3(Int.MaxValue - 1) === 331) }
  test("P3.600851475143") { assert(p3(600851475143L) === 6857) }
  /**
   * **************************************************************************************************************
   * p4
   * Find the largest palindrome made from the product of two 3-digit numbers.
   * published 2001.11.16, updated 2012.09.18, solved by 136372 people, solved by me=true
   * ***************************************************************************************************************
   * A palindromic number reads the same both ways. The largest palindrome made from the product of two 2-digit numbers is 9009 = 91 99.
   * Find the largest palindrome made from the product of two 3-digit numbers.
   */
  def isPalindrome(n: Int): Boolean = n.toString.equalsIgnoreCase(n.toString.reverse)
  def p4(dig: Int): Int = {
    val limit: Int = math.pow(10.0, dig.toDouble).toInt
    var highest: Int = 0
    for (i <- 2 to limit) {
      for (j <- 2 to limit) {
        val prod = i * j
        if (isPalindrome(prod) && (prod > highest)) highest = prod
      }
    }
    highest
  }
  test("isPalindrome(121)") { assert(isPalindrome(121) === true) }
  test("isPalindrome(9009)") { assert(isPalindrome(9009) === true) }
  test("isPalindrome(9010)") { assert(isPalindrome(9010) === false) }
  test("p4.2") { assert(p4(2) === 9009) }
  test("p4.3") { assert(p4(3) === 906609) }
  /**
   * **************************************************************************************************************
   * p5
   * What is the smallest number divisible by each of the numbers 1 to 20?
   * published 2001.11.30, updated 2012.09.18, solved by 150841 people, solved by me=true
   * ***************************************************************************************************************
   * 2520 is the smallest number that can be divided by each of the numbers from 1 to 10 without any remainder.
   * What is the smallest positive number that is evenly divisible by all of the numbers from 1 to 20?
   */
  def p5(max: Long): Long = {
    val div = List.range(1, max + 1, 1)
    def p5a(x: Long): Long = if (div.forall(x % _ == 0)) x else p5a(x + 1)
    p5a(max)
  }
  test("P5.10") { assert(p5(10) === 2520) }
  //test("P5.20") { assert(p5(20) === 232792560) } // 10 secs
  /**
   * **************************************************************************************************************
   * p6
   * What is the difference between the sum of the squares and the square of the sums?
   * published 2001.12.14, updated 2012.09.18, solved by 152195 people, solved by me=true
   * ***************************************************************************************************************
   * The sum of the squares of the first ten natural numbers is 12 + 22 + ... + 102 = 385
   * The square of the sum of the first ten natural numbers is (1 + 2 + ... + 10)2 = 552 = 3025
   * Hence the difference between the sum of the squares of the first ten natural numbers and the square of the sum is 3025  385 = 2640.
   * Find the difference between the sum of the squares of the first one hundred natural numbers and the square of the sum.
   */
  def p6(max: Long): Long = {
    val numList = List.range(1, max + 1)
    val sumOfSquares = numList.foldLeft(0L)((x, y) => (x + (y * y)))
    val sum = numList.foldLeft(0L)(_ + _)
    val squareOfSum = sum * sum
    val diff = squareOfSum - sumOfSquares
    diff
  }
  test("P6.10") { assert(p6(10) === 2640) }
  test("P6.100") { assert(p6(100) === 25164150) }
  /**
   * **************************************************************************************************************
   * p7
   * Find the 10001st prime.
   * published 2001.12.28, updated 2012.09.18, solved by 129158 people, solved by me=true
   * ***************************************************************************************************************
   * By listing the first six prime numbers: 2, 3, 5, 7, 11, and 13, we can see that the 6th prime is 13.
   * What is the 10 001st prime number?
   */
  def p7(n: Int): Long = {
    val maxPrimes = Primes.primesBelow(200000)
    maxPrimes(n - 1)
  }
  test("p7.6") { assert(p7(6) === 13) }
  test("p7.10001") { assert(p7(10001) === 104743) }
  /**
   * **************************************************************************************************************
   * p8
   * Discover the largest product of five consecutive digits in the 1000-digit number.
   * published 2002.01.11, updated 2012.09.18, solved by 113991 people, solved by me=true
   * ***************************************************************************************************************
   * Find the greatest product of five consecutive digits in the 1000-digit number.
   */
  val p8String = "73167176531330624919225119674426574742355349194934" +
    "96983520312774506326239578318016984801869478851843" +
    "85861560789112949495459501737958331952853208805511" +
    "12540698747158523863050715693290963295227443043557" +
    "66896648950445244523161731856403098711121722383113" +
    "62229893423380308135336276614282806444486645238749" +
    "30358907296290491560440772390713810515859307960866" +
    "70172427121883998797908792274921901699720888093776" +
    "65727333001053367881220235421809751254540594752243" +
    "52584907711670556013604839586446706324415722155397" +
    "53697817977846174064955149290862569321978468622482" +
    "83972241375657056057490261407972968652414535100474" +
    "82166370484403199890008895243450658541227588666881" +
    "16427171479924442928230863465674813919123162824586" +
    "17866458359124566529476545682848912883142607690042" +
    "24219022671055626321111109370544217506941658960408" +
    "07198403850962455444362981230987879927244284909188" +
    "84580156166097919133875499200524063689912560717606" +
    "05886116467109405077541002256983155200055935729725" +
    "71636269561882670428252483600823257530420752963450"
  def p8(goal: String): Long = {
    var highest: Long = 0
    for (i <- 0 to goal.length() - 5) {
      var prod: Long = 1
      for (j <- 0 until 5) prod *= goal(i + j).toLong - val0
      if (prod > highest) highest = prod
    }
    highest
  }
  test("p8.12345") { assert(p8("12345") === 120) }
  test("p8.p8String") { assert(p8(p8String) === 40824) }
  /**
   * **************************************************************************************************************
   * p9
   * Find the only Pythagorean triplet, {<var>a</var>, <var>b</var>, <var>c</var>}, for which <var>a</var> + <var>b</var> + <var>c</var> = 1000.
   * published 2002.01.25, updated 2012.09.18, solved by 114273 people, solved by me=true
   * ***************************************************************************************************************
   * A Pythagorean triplet is a set of three natural numbers, a < b < c, for which,
   * a^2 + b^2 = c^2
   * For example, 3^2 + 4^2 = 9 + 16 = 25 = 5^2.
   * There exists exactly one Pythagorean triplet for which a + b + c = 1000.
   * Find the product abc.
   */
  def p9(n: Int): Long = {
    for (i <- 1 to n; j <- i + 1 to n; k <- j + 1 to n) {
      val left = i * i + j * j
      val right = k * k
      val sum = i + j + k
      val prod = i * j * k
      //if (left == right) println("i=%d,j=%d,k=%d,l=%d,r=%d,s=%d,p=%d".format(i, j, k, left, right, sum, prod))
      if ((left == right) && (sum == n)) return prod
    }
    0
    //if (n == 12) 60 else n
  }
  test("p9(12)") { assert(p9(12) === 60) }
  test("p9(1000)") { assert(p9(1000) === 31875000) }
  /**
   * **************************************************************************************************************
   * p10
   * Calculate the sum of all the primes below two million.
   * published 2002.02.08, updated 2012.09.18, solved by 103876 people, solved by me=true
   * ***************************************************************************************************************
   * The sum of the primes below 10 is 2 + 3 + 5 + 7 = 17.
   * Find the sum of all the primes below two million.
   */
  object Primes {
    /*    def ints(n: Int): Stream[Int] = Stream.cons(n, ints(n + 1))
    def sieve3(nums: Stream[Int]): Stream[Int] =
      Stream.cons(nums.head, sieve3((nums.tail) filter (_ % nums.head != 0)))
    def primes = sieve3(ints(2))
    def primesBelow(max: Int) = primes take max toList
    //def isPrime(n: Int) = primes take n contains n
     * */
    //
    def from(n: Int): Stream[Int] = n #:: from(n + 1)
    val nats = from(0)
    def sieve(s: Stream[Int]): Stream[Int] = s.head #:: sieve(s.tail filterNot (_ % s.head == 0))
    lazy val primes = sieve(from(2))
    def isPrime(n: Int) = n > 1 && (Iterator.from(2) takeWhile (d => d * d <= n) forall (n % _ != 0))
    def primesBelow(max: Int): List[Int] = {
      val sieve2: Array[Int] = (3 to max by 2).toArray
      for (i <- 0 until sieve2.length) {
        val n: Int = sieve2(i)
        if (n != 0) for (j <- i.toInt + n until sieve2.length by n) {
          sieve2(j) = 0
        }
      }
      val result: List[Int] = 2 :: sieve2.filter(0 != _).toList
      result
    }
  }

  def p10(max: Int) = {
    lazy val myPrimes = Primes.primes.filter(_ < max)
    //myPrimes.foldLeft(0L)(_ + _)
    Primes.primesBelow(max).foldLeft(0L)(_ + _)
  }
  test("P10.10") { assert(p10(10) === 17) }
  test("P10.22") { assert(p10(22) === 77) }
  test("P10.100") { assert(p10(100) === 1060) }
  test("P10.1K") { assert(p10(1000) === 76127) }
  test("P10.10K") { assert(p10(10000) === 5736396) }
  test("P10.100K") { assert(p10(100000) === 454396537) }
  test("P10.500K") { assert(p10(500000) === 9914236195L) }
  test("P10.2M") { assert(p10(2000000) === 142913828922L) }
  /**
   * **************************************************************************************************************
   * p11
   * What is the greatest product of four adjacent numbers on the same straight line in the 20 by 20 grid?
   * published 2002.02.22, updated 2012.09.18, solved by 78310 people, solved by me=true
   * ***************************************************************************************************************
   * In the 2020 grid below, four numbers along a diagonal line have been marked in red.
   * The product of these numbers is 26  63  78  14 = 1788696.
   * What is the greatest product of four adjacent numbers in any direction (up, down, left, right, or diagonally) in the 2020 grid?
   */
  val p11A2: Array[Array[Int]] = Array( //Array.ofDim[Int](20, 20)
    Array(8, 02, 22, 97, 38, 15, 00, 40, 00, 75, 04, 05, 07, 78, 52, 12, 50, 77, 91, 8),
    Array(49, 49, 99, 40, 17, 81, 18, 57, 60, 87, 17, 40, 98, 43, 69, 48, 04, 56, 62, 00),
    Array(81, 49, 31, 73, 55, 79, 14, 29, 93, 71, 40, 67, 53, 88, 30, 03, 49, 13, 36, 65),
    Array(52, 70, 95, 23, 04, 60, 11, 42, 69, 24, 68, 56, 01, 32, 56, 71, 37, 02, 36, 91),
    Array(22, 31, 16, 71, 51, 67, 63, 89, 41, 92, 36, 54, 22, 40, 40, 28, 66, 33, 13, 80),
    Array(24, 47, 32, 60, 99, 03, 45, 02, 44, 75, 33, 53, 78, 36, 84, 20, 35, 17, 12, 50),
    Array(32, 98, 81, 28, 64, 23, 67, 10, 26, 38, 40, 67, 59, 54, 70, 66, 18, 38, 64, 70),
    Array(67, 26, 20, 68, 02, 62, 12, 20, 95, 63, 94, 39, 63, 8, 40, 91, 66, 49, 94, 21),
    Array(24, 55, 58, 05, 66, 73, 99, 26, 97, 17, 78, 78, 96, 83, 14, 88, 34, 89, 63, 72),
    Array(21, 36, 23, 9, 75, 00, 76, 44, 20, 45, 35, 14, 00, 61, 33, 97, 34, 31, 33, 95),
    Array(78, 17, 53, 28, 22, 75, 31, 67, 15, 94, 03, 80, 04, 62, 16, 14, 9, 53, 56, 92),
    Array(16, 39, 05, 42, 96, 35, 31, 47, 55, 58, 88, 24, 00, 17, 54, 24, 36, 29, 85, 57),
    Array(86, 56, 00, 48, 35, 71, 89, 07, 05, 44, 44, 37, 44, 60, 21, 58, 51, 54, 17, 58),
    Array(19, 80, 81, 68, 05, 94, 47, 69, 28, 73, 92, 13, 86, 52, 17, 77, 04, 89, 55, 40),
    Array(04, 52, 8, 83, 97, 35, 99, 16, 07, 97, 57, 32, 16, 26, 26, 79, 33, 27, 98, 66),
    Array(88, 36, 68, 87, 57, 62, 20, 72, 03, 46, 33, 67, 46, 55, 12, 32, 63, 93, 53, 69),
    Array(04, 42, 16, 73, 38, 25, 39, 11, 24, 94, 72, 18, 8, 46, 29, 32, 40, 62, 76, 36),
    Array(20, 69, 36, 41, 72, 30, 23, 88, 34, 62, 99, 69, 82, 67, 59, 85, 74, 04, 36, 16),
    Array(20, 73, 35, 29, 78, 31, 90, 01, 74, 31, 49, 71, 48, 86, 81, 16, 23, 57, 05, 54),
    Array(01, 70, 54, 71, 83, 51, 54, 69, 16, 92, 33, 48, 61, 43, 52, 01, 89, 19, 67, 48))
  def p11(arr: Array[Array[Int]]): Long = { // assumes square array
    val kk = 4
    var highest: Long = 0
    var horiz: Long = 0
    var vert: Long = 0
    var diag: Long = 0
    var revDiag: Long = 0
    def getHoriz(m: Int): Long = {
      var prodRow: Long = 0
      var s: String = ""
      for (j <- 0 to (arr(0).length - kk)) {
        var prod: Long = 1L
        for (k <- 0 until kk) { prod *= arr(m)(j + k); s = "h(%d,%d)=%d".format(j, k, prod) }
        if (prodRow < prod) prodRow = prod
      }
      prodRow
    }
    def getVert(m: Int): Long = {
      var prodColumn: Long = 0
      var s: String = ""
      for (j <- 0 to (arr.length - kk)) {
        var prod: Long = 1L
        for (k <- 0 until kk) { prod *= arr(j + k)(m); s = "v(%d,%d)=%d".format(j, k, prod) }
        if (prodColumn < prod) prodColumn = prod
      }
      prodColumn
    }
    def getDiag(m: Int, n: Int): Long = {
      var diag: Long = 1L
      if (m + kk >= arr.length || n + kk >= arr(0).length) 0
      else for (i <- 0 until kk) diag *= arr(m + i)(m + i)
      diag
    }
    def getRevDiag(m: Int, n: Int): Long = {
      var rev: Long = 1L
      if (m + kk >= arr.length || n < kk) 0
      else for (i <- 0 until kk) rev *= arr(m + i)(n - i)
      rev
    }
    for (i <- 0 until arr.length) { val temp = getHoriz(i); if (horiz < temp) horiz = temp }
    for (i <- 0 until arr(0).length) { val temp = getVert(i); if (vert < temp) vert = temp }
    for (i <- 0 until arr.length; j <- 0 until arr(0).length) { val temp = getDiag(i, j); if (diag < temp) diag = temp }
    for (i <- 0 until arr.length; j <- 0 until arr(0).length) { val temp = getRevDiag(i, j); if (revDiag < temp) revDiag = temp }
    if (highest < horiz) highest = horiz
    if (highest < vert) highest = vert
    if (highest < diag) highest = diag
    if (highest < revDiag) highest = revDiag
    highest
  }
  test("p11") { assert(p11(p11A2) === 70600674L) }
  /**
   * **************************************************************************************************************
   * p12
   * What is the value of the first triangle number to have over five hundred divisors?
   * published 2002.03.08, updated 2012.09.18, solved by 69655 people, solved by me=false
   * ***************************************************************************************************************
   * The sequence of triangle numbers is generated by adding the natural numbers.
   * So the 7th triangle number would be 1 + 2 + 3 + 4 + 5 + 6 + 7 = 28.
   * The first ten terms would be:
   * 1, 3, 6, 10, 15, 21, 28, 36, 45, 55, ...
   * Let us list the factors of the first seven triangle numbers:
   * 1: 1
   * 3: 1,3
   * 6: 1,2,3,6
   * 10: 1,2,5,10
   * 15: 1,3,5,15
   * 21: 1,3,7,21
   * 28: 1,2,4,7,14,28
   * We can see that 28 is the first triangle number to have over five divisors.
   * What is the value of the first triangle number to have over five hundred divisors?
   */

  def triangleL(n: Long): Long = if (n <= 1) n else n + triangleL(n - 1)
  def triangleB(n: Long): BigInt = if (n <= 1) n else n + triangleB(n - 1)
  def nDivL(n: Long): Int = {
    val s = Range.Long.inclusive(1, n, 1)
    (for (i <- s if (0 == n % i)) yield i).length
  }
  def nDivB(n: BigInt): Int = {
    val big1 = BigInt("1")
    val s = Range.BigInt.inclusive(big1, n, big1)
    (for (i <- s if (0 == n % i)) yield i).length
  }
  lazy val tsBS: Stream[BigInt] = Stream.from(1).map(triangleB(_))
  lazy val tsLS: Stream[Long] = Stream.from(1).map(triangleL(_))
  lazy val nDivBS: Stream[Int] = tsBS.map(t => nDivB(t))
  lazy val nDivLS: Stream[Int] = tsLS.map(t => nDivL(t))
  def p12zB(n: Int): BigInt = {
    if (n < 1) 0
    else for (i <- 1 to Int.MaxValue) if (n < nDivBS(i)) return tsBS(i)
    0
  }
  def p12zL(n: Int): Long = {
    if (n < 1) 0
    else for (i <- 1 to Int.MaxValue) if (n < nDivLS(i)) return tsLS(i)
    0
  }
  lazy val p12StreamB: Stream[BigInt] = Stream.from(0).map(p12zB(_))
  lazy val p12StreamL: Stream[Long] = Stream.from(0).map(p12zL(_))
  def p12(n: Int): BigInt = {
    if (n < 300) p12zL(n) else p12zB(n)
    //if (n < 300) p12StreamL(n) else p12StreamB(n)
  }

  test("p12.5") { assert(p12(5) === 28L) }
  test("p12.10") { assert(p12(10) === 120L) }
  test("p12.50") { assert(p12(50) === 25200L) }
  test("p12.100") { assert(p12(100) === 73920L) }
  ignore("p12.150") { assert(p12(150) === 749700L) } // 6.4 seconds, 50
  ignore("p12.200") { assert(p12(200) === 2031120L) } // 23 seconds, 178
  ignore("p12.300") { assert(p12(300) === 2162160L) } // 260 seconds
  ignore("p12.310") { assert(p12(310) === 2162160L) }
  ignore("p12.320") { assert(p12(320) === 17907120L) }
  ignore("p12.325") { assert(p12(325) === 17907120L) }
  ignore("p12.350") { assert(p12(350) === 17907120L) }
  ignore("p12.400") { assert(p12(400) === 17907120L) }
  ignore("p12.450") { assert(p12(450) === 17907120L) }
  ignore("p12.500") { assert(p12(500) === 123L) }
  /**
   * **************************************************************************************************************
   * p13
   * Find the first ten digits of the sum of one-hundred 50-digit numbers.
   * published 2002.03.22, updated 2012.09.18, solved by 76188 people, solved by me=true
   * ***************************************************************************************************************
   * Work out the first ten digits of the sum of the following one-hundred 50-digit numbers.
   */
  val numArray: Array[BigInt] = Array(BigInt(
    "37107287533902102798797998220837590246510135740250"), BigInt(
    "46376937677490009712648124896970078050417018260538"), BigInt(
    "74324986199524741059474233309513058123726617309629"), BigInt(
    "91942213363574161572522430563301811072406154908250"), BigInt(
    "23067588207539346171171980310421047513778063246676"), BigInt(
    "89261670696623633820136378418383684178734361726757"), BigInt(
    "28112879812849979408065481931592621691275889832738"), BigInt(
    "44274228917432520321923589422876796487670272189318"), BigInt(
    "47451445736001306439091167216856844588711603153276"), BigInt(
    "70386486105843025439939619828917593665686757934951"), BigInt(
    "62176457141856560629502157223196586755079324193331"), BigInt(
    "64906352462741904929101432445813822663347944758178"), BigInt(
    "92575867718337217661963751590579239728245598838407"), BigInt(
    "58203565325359399008402633568948830189458628227828"), BigInt(
    "80181199384826282014278194139940567587151170094390"), BigInt(
    "35398664372827112653829987240784473053190104293586"), BigInt(
    "86515506006295864861532075273371959191420517255829"), BigInt(
    "71693888707715466499115593487603532921714970056938"), BigInt(
    "54370070576826684624621495650076471787294438377604"), BigInt(
    "53282654108756828443191190634694037855217779295145"), BigInt(
    "36123272525000296071075082563815656710885258350721"), BigInt(
    "45876576172410976447339110607218265236877223636045"), BigInt(
    "17423706905851860660448207621209813287860733969412"), BigInt(
    "81142660418086830619328460811191061556940512689692"), BigInt(
    "51934325451728388641918047049293215058642563049483"), BigInt(
    "62467221648435076201727918039944693004732956340691"), BigInt(
    "15732444386908125794514089057706229429197107928209"), BigInt(
    "55037687525678773091862540744969844508330393682126"), BigInt(
    "18336384825330154686196124348767681297534375946515"), BigInt(
    "80386287592878490201521685554828717201219257766954"), BigInt(
    "78182833757993103614740356856449095527097864797581"), BigInt(
    "16726320100436897842553539920931837441497806860984"), BigInt(
    "48403098129077791799088218795327364475675590848030"), BigInt(
    "87086987551392711854517078544161852424320693150332"), BigInt(
    "59959406895756536782107074926966537676326235447210"), BigInt(
    "69793950679652694742597709739166693763042633987085"), BigInt(
    "41052684708299085211399427365734116182760315001271"), BigInt(
    "65378607361501080857009149939512557028198746004375"), BigInt(
    "35829035317434717326932123578154982629742552737307"), BigInt(
    "94953759765105305946966067683156574377167401875275"), BigInt(
    "88902802571733229619176668713819931811048770190271"), BigInt(
    "25267680276078003013678680992525463401061632866526"), BigInt(
    "36270218540497705585629946580636237993140746255962"), BigInt(
    "24074486908231174977792365466257246923322810917141"), BigInt(
    "91430288197103288597806669760892938638285025333403"), BigInt(
    "34413065578016127815921815005561868836468420090470"), BigInt(
    "23053081172816430487623791969842487255036638784583"), BigInt(
    "11487696932154902810424020138335124462181441773470"), BigInt(
    "63783299490636259666498587618221225225512486764533"), BigInt(
    "67720186971698544312419572409913959008952310058822"), BigInt(
    "95548255300263520781532296796249481641953868218774"), BigInt(
    "76085327132285723110424803456124867697064507995236"), BigInt(
    "37774242535411291684276865538926205024910326572967"), BigInt(
    "23701913275725675285653248258265463092207058596522"), BigInt(
    "29798860272258331913126375147341994889534765745501"), BigInt(
    "18495701454879288984856827726077713721403798879715"), BigInt(
    "38298203783031473527721580348144513491373226651381"), BigInt(
    "34829543829199918180278916522431027392251122869539"), BigInt(
    "40957953066405232632538044100059654939159879593635"), BigInt(
    "29746152185502371307642255121183693803580388584903"), BigInt(
    "41698116222072977186158236678424689157993532961922"), BigInt(
    "62467957194401269043877107275048102390895523597457"), BigInt(
    "23189706772547915061505504953922979530901129967519"), BigInt(
    "86188088225875314529584099251203829009407770775672"), BigInt(
    "11306739708304724483816533873502340845647058077308"), BigInt(
    "82959174767140363198008187129011875491310547126581"), BigInt(
    "97623331044818386269515456334926366572897563400500"), BigInt(
    "42846280183517070527831839425882145521227251250327"), BigInt(
    "55121603546981200581762165212827652751691296897789"), BigInt(
    "32238195734329339946437501907836945765883352399886"), BigInt(
    "75506164965184775180738168837861091527357929701337"), BigInt(
    "62177842752192623401942399639168044983993173312731"), BigInt(
    "32924185707147349566916674687634660915035914677504"), BigInt(
    "99518671430235219628894890102423325116913619626622"), BigInt(
    "73267460800591547471830798392868535206946944540724"), BigInt(
    "76841822524674417161514036427982273348055556214818"), BigInt(
    "97142617910342598647204516893989422179826088076852"), BigInt(
    "87783646182799346313767754307809363333018982642090"), BigInt(
    "10848802521674670883215120185883543223812876952786"), BigInt(
    "71329612474782464538636993009049310363619763878039"), BigInt(
    "62184073572399794223406235393808339651327408011116"), BigInt(
    "66627891981488087797941876876144230030984490851411"), BigInt(
    "60661826293682836764744779239180335110989069790714"), BigInt(
    "85786944089552990653640447425576083659976645795096"), BigInt(
    "66024396409905389607120198219976047599490197230297"), BigInt(
    "64913982680032973156037120041377903785566085089252"), BigInt(
    "16730939319872750275468906903707539413042652315011"), BigInt(
    "94809377245048795150954100921645863754710598436791"), BigInt(
    "78639167021187492431995700641917969777599028300699"), BigInt(
    "15368713711936614952811305876380278410754449733078"), BigInt(
    "40789923115535562561142322423255033685442488917353"), BigInt(
    "44889911501440648020369068063960672322193204149535"), BigInt(
    "41503128880339536053299340368006977710650566631954"), BigInt(
    "81234880673210146739058568557934581403627822703280"), BigInt(
    "82616570773948327592232845941706525094512325230608"), BigInt(
    "22918802058777319719839450180888072429661980811197"), BigInt(
    "77158542502016545090413245809786882778948721859617"), BigInt(
    "72107838435069186155435662884062257473692284509516"), BigInt(
    "20849603980134001723930671666823555245252804609722"), BigInt(
    "53503534226472524250874054075591789781264330331690"))
  def p13(n: Int): String = numArray.sum.toString.take(n)
  val val0: Long = '0'.toLong
  def fc(y: Char): Long = (y.toLong - val0)
  test("p13.2") { assert(p13(2) === "55") }
  test("p13.10") { assert(p13(10) === "5537376230") }
  /**
   * **************************************************************************************************************
   * p14
   * Find the longest sequence using a starting number under one million.
   * published 2002.04.05, updated 2012.09.18, solved by 74244 people, solved by me=true
   * ***************************************************************************************************************
   * The following iterative sequence is defined for the set of positive integers:
   *
   * n  n/2 (n is even)
   * n  3n + 1 (n is odd)
   *
   * Using the rule above and starting with 13, we generate the following sequence:
   *
   * 13  40  20  10  5  16  8  4  2  1
   * It can be seen that this sequence (starting at 13 and finishing at 1) contains 10 terms.
   * Although it has not been proved yet (Collatz Problem), it is thought that all starting numbers finish at 1.
   *
   * Which starting number, under one million, produces the longest chain?
   *
   * NOTE: Once the chain starts the terms are allowed to go above one million.
   */

  def p14(n: Long): (Long, Long) = {
    var highest: Long = 0
    var answer: Long = 0
    def seq(acc: Long, j: Long): Long = { if (j == 1) 1 + acc else { if (0 == (j % 2)) seq(1 + acc, j / 2) else seq(1 + acc, (j * 3) + 1) } }
    for (i <- (n - 1) until (n / 2) by -1) { val s: Long = seq(0, i); if (highest < s) { highest = s; answer = i } }
    (answer, highest)
  }
  test("p14.5") { assert(p14(5) === (3, 8)) }
  test("p14.10") { assert(p14(10) === (9, 20)) }
  test("p14.100") { assert(p14(100) === (97, 119)) }
  test("p14.1000") { assert(p14(1000) === (871, 179)) }
  test("p14.10000") { assert(p14(10000) === (6171, 262)) }
  test("p14.100000") { assert(p14(100000) === (77031, 351)) }
  test("p14.200000") { assert(p14(200000) === (156159, 383)) }
  test("p14.500000") { assert(p14(500000) === (410011, 449)) }
  test("p14.1000000") { assert(p14(1000000) === (837799, 525)) }
  /**
   * **************************************************************************************************************
   * p15
   * Starting in the top left corner in a 20 by 20 grid, how many routes are there to the bottom right corner?
   * http://projecteuler.net/problem=15
   * published 2002.04.19, updated 2012.09.18, solved by 61142 people, solved by me=true
   * ***************************************************************************************************************
   * Starting in the top left corner of a 2x2 grid, there are 6 routes (without backtracking) to the bottom right corner.
   * How many routes are there through a 20x20 grid?
   */
  def p15(m: Int): BigInt = {
    def p15a(n: Int): List[BigInt] = {
      val big1: BigInt = BigInt("1")
      if (n == 1) Stream.continually(List(big1)).flatten.take(m + 2).toList
      else {
        // println("n= " + n)
        val prev: List[BigInt] = p15a(n - 1).take(m + 2)
        // println("prev= " + prev)
        val seq: List[Int] = (0 until m + 2).toList
        val next: List[BigInt] = (for (i <- seq) yield ((prev.take(i + 1)).sum))
        //println("next =" + next)
        next
      }
    }
    p15a(m + 1).take(m + 1).last
  }
  test("p15.2") { assert(p15(2) === 6) }
  test("p15.20") { assert(p15(20) === BigInt("137846528820")) }
  /**
   * **************************************************************************************************************
   * p16
   * What is the sum of the digits of the number 2<sup>1000</sup>?
   * http://projecteuler.net/problem=16
   * published 2002.05.03, updated 2012.09.18, solved by 80520 people, solved by me=true
   * ***************************************************************************************************************
   * 2^15 = 32768 and the sum of its digits is 3 + 2 + 7 + 6 + 8 = 26.
   * What is the sum of the digits of the number 2^1000?
   */
  def p16(n: Int): Long = {
    val nString: String = BigInt(2).pow(n).toString
    var sum: Long = 0
    for (i <- 0 until nString.length) sum += nString(i) - val0
    sum
  }
  test("p16.15") { assert(p16(15) === 26) }
  test("p16.1k") { assert(p16(1000) === 1366) }
  /**
   * **************************************************************************************************************
   * p17
   * How many letters would be needed to write all the numbers in words from 1 to 1000?
   * http://projecteuler.net/problem=17
   * published 2002.05.17, updated 2012.09.18, solved by 51237 people, solved by me=false
   * ***************************************************************************************************************
   * If the numbers 1 to 5 are written out in words: one, two, three, four, five, then there are 3 + 3 + 5 + 4 + 4 = 19 letters used in total.
   * If all the numbers from 1 to 1000 (one thousand) inclusive were written out in words, how many letters would be used?
   * NOTE: Do not count spaces or hyphens. For example, 342 (three hundred and forty-two) contains 23 letters
   * and 115 (one hundred and fifteen) contains 20 letters.
   * The use of "and" when writing out numbers is in compliance with British usage.
   */
  def p17All(n: Int): Long = {
    val numList = for (i <- 1 to n) yield p17Single(i)
    val numSum: Long = numList.foldLeft(0L)(_ + _)
    numSum
  }
  def p17Single(n: Int): Long = {
    val standardWords0: List[String] = List("Zero", "One", "Two", "Three", "Four", "Five", "Six", "Seven", "Eight", "Nine", "Ten",
      "Eleven", "Twelve", "Thirteen", "Fourteen", "Fifteen", "Sixteen", "Seventeen", "Eighteen", "Nineteen")
    val standardTens: List[String] = List("Zero", "Ten", "Twenty", "Thirty", "Forty", "Fifty", "Sixty", "Seventy", "Eighty", "Ninety")

    def words(acc: List[String], n: Int): List[String] = {
      if (n == 0) acc
      else if (n == 1000) List("One", "Thousand")
      else {
        val over100 = n / 100
        val under100 = n % 100
        val hundredsList = if (over100 > 0) words(List(), over100) ::: List("Hundred") else List()
        val tens = under100 / 10
        val ones = under100 % 10
        val hundredsList2 = if ((ones > 0 || tens > 0) && over100 > 0) hundredsList ::: List("and") else hundredsList
        val tensList = if (tens <= 1) List() else List(standardTens(tens))
        val onesList = if (tens == 1) List(standardWords0(ones + 10)) else if (ones == 0) List() else List(standardWords0(ones))
        val result = hundredsList2 ::: tensList ::: onesList
        //println(result)
        result
      }
    }
    words(List(), n).foldLeft(0)(_ + _.length)

  }
  test("p17S.342") { assert(p17Single(342) === 23) }
  test("p17S.115") { assert(p17Single(115) === 20) }
  test("p17S.1") { assert(p17Single(1) === 3) }
  test("p17S.2") { assert(p17Single(2) === 3) }
  test("p17S.3") { assert(p17Single(3) === 5) }
  test("p17S.4") { assert(p17Single(4) === 4) }
  test("p17S.5") { assert(p17Single(5) === 4) }
  test("p17S.13") { assert(p17Single(13) === 8) }
  test("p17S.30") { assert(p17Single(30) === 6) }
  test("p17S.86") { assert(p17Single(86) === 6 + 3) }
  test("p17S.100") { assert(p17Single(100) === 3 + 7) }
  test("p17S.400") { assert(p17Single(400) === 4 + 7) }
  test("p17S.999") { assert(p17Single(999) === 24) }
  test("p17S.1K") { assert(p17Single(1000) === 3 + 8) }
  test("p17All.5") { assert(p17All(5) === 3 + 3 + 5 + 4 + 4) }
  test("p17All.1K") { assert(p17All(1000) === 21124) }
  /**
   * **************************************************************************************************************
   * p18
   * Find the maximum sum travelling from the top of the triangle to the base.
   * http://projecteuler.net/problem=18
   * published 2002.05.31, updated 2012.09.18, solved by 51444 people, solved by me=true
   * ***************************************************************************************************************
   */
  def p18 = p1867(List("euler", "p18triangle.txt"))
  test("p18") { assert(p18 === 1074) }
  /**
   * **************************************************************************************************************
   * p19
   * How many Sundays fell on the first of the month during the twentieth century?
   * http://projecteuler.net/problem=19
   * published 2002.06.14, updated 2012.09.18, solved by 46846 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p20
   * Find the sum of digits in 100!
   * http://projecteuler.net/problem=20
   * published 2002.06.21, updated 2012.09.18, solved by 76626 people, solved by me=true
   * ***************************************************************************************************************
   * n! means n  (n  1)  ...  3  2  1
   * For example, 10! = 10  9  ...  3  2  1 = 3628800,
   * and the sum of the digits in the number 10! is 3 + 6 + 2 + 8 + 8 + 0 + 0 = 27.
   * Find the sum of the digits in the number 100!
   */
  def facRec(acc: BigInt, nn: Int): BigInt = {
    if (nn <= 1) acc
    else facRec(acc * nn, nn - 1)
  }
  def p20(n: Int): Long = {
    val nStr: String = facRec(1, n).toString
    (for (c <- nStr) yield fc(c)).sum
  }
  test("p20.4") { assert(p20(5) === 3) }
  test("p20.10") { assert(p20(10) === 27) }
  test("p20.100") { assert(p20(100) === 648) }
  /**
   * **************************************************************************************************************
   * p21
   * Evaluate the sum of all amicable pairs under 10000.
   * http://projecteuler.net/problem=21
   * published 2002.07.05, updated 2012.09.18, solved by 50959 people, solved by me=false
   * ***************************************************************************************************************
   * Let d(n) be defined as the sum of proper divisors of n (numbers less than n which divide evenly into n).
   * If d(a) = b and d(b) = a, where a  b, then a and b are an amicable pair and each of a and b are called amicable numbers.
   * For example, the proper divisors of 220 are 1, 2, 4, 5, 10, 11, 20, 22, 44, 55 and 110; therefore d(220) = 284.
   * The proper divisors of 284 are 1, 2, 4, 71 and 142; so d(284) = 220.
   * Evaluate the sum of all the amicable numbers under 10000.
   */
  def divisors(n: Int): List[Int] = (for (i <- 1 until n; if (0 == n % i)) yield i).toList
  def amicable(n: Int): Boolean = {
    val sum1 = divisors(n).foldLeft(0)(_ + _)
    val sum2 = divisors(sum1).foldLeft(0)(_ + _)
    val pair: Boolean = (n == sum2 && n != sum1)
    pair
  }
  def p21(max: Int): Int = {
    val pairList: List[Int] = (for (i <- 219 until max; if (amicable(i))) yield i).toList
    pairList.foldLeft(0)(_ + _)
  }
  test("p21.300") { assert(p21(300) === 504) }
  test("p21.10K") { assert(p21(10000) === 31626) }
  /**
   * **************************************************************************************************************
   * p22
   * What is the total of all the name scores in the file of first names?
   * http://projecteuler.net/problem=22
   * published 2002.07.19, updated 2012.09.18, solved by 47552 people, solved by me=true
   * ***************************************************************************************************************
   * Using names.txt (right click and 'Save Link/Target As...'), a 46K text file containing over five-thousand first names,
   * begin by sorting it into alphabetical order. Then working out the alphabetical value for each name,
   * multiply this value by its alphabetical position in the list to obtain a name score.
   *
   * For example, when the list is sorted into alphabetical order, COLIN, which is worth 3 + 15 + 12 + 9 + 14 = 53,
   * is the 938th name in the list. So, COLIN would obtain a score of 938  53 = 49714.
   *
   * What is the total of all the name scores in the file?
   */

  def p22(name: String): Long = {
    def encodeChar(c: Char): Int = {
      val res = (c - 'A') + 1
      //println("encodeChar(%s)=%d".format(c, res))
      res
    }
    def encodeString(str: String): Int = {
      val result = str.foldLeft(0)(_ + encodeChar(_))
      //println("encodeString(%s) = %d".format(str, result))
      result
    }
    val nameList: List[String] = Euler.loadFile(List("euler", "p22names.txt"))
    val unsorted = nameList.head.split(",")
    val stripped = unsorted map (_.replace("\"", ""))
    //println("unsorted(%d)".format(unsorted.length))
    val sorted = stripped.sortWith(_ < _)
    //println("sorted(%d)".format(sorted.length))
    if (name.isEmpty() || name == "") {
      val products: List[Int] = (for (i <- 0 until sorted.length) yield (i + 1) * encodeString(sorted(i))).toList
      products.foldLeft(0)(_ + _)
    } else {
      val singleNdx = 1 + sorted.indexOf(name)
      val encoded = encodeString(name)
      singleNdx * encoded
    }
  }
  test("p22(COLIN)") { assert(p22("COLIN") === 49714) }
  test("p22") { assert(p22("") === 871198282) }
  /**
   * **************************************************************************************************************
   * p23
   * Find the sum of all the positive integers which cannot be written as the sum of two abundant numbers.
   * http://projecteuler.net/problem=23
   * published 2002.08.02, updated 2012.09.18, solved by 35108 people, solved by me=false
   * ***************************************************************************************************************
   * A perfect number is a number for which the sum of its proper divisors is exactly equal to the number.
   * For example, the sum of the proper divisors of 28 would be 1 + 2 + 4 + 7 + 14 = 28, which means that 28 is a perfect number.
   * A number n is called deficient if the sum of its proper divisors is less than n and it is called abundant if this sum exceeds n.
   * As 12 is the smallest abundant number, 1 + 2 + 3 + 4 + 6 = 16, the smallest number that can be written as the sum of two abundant numbers is 24.
   * By mathematical analysis, it can be shown that all integers greater than 28123 can be written as the sum of two abundant numbers.
   * However, this upper limit cannot be reduced any further by analysis even though it is known that the greatest number
   * that cannot be expressed as the sum of two abundant numbers is less than this limit.
   * Find the sum of all the positive integers which cannot be written as the sum of two abundant numbers.
   */
  def sumDiv(n: Int): Int = divisors(n).foldLeft(0)(_ + _)
  def isPerfect(n: Int): Boolean = (sumDiv(n) == n)
  def isDeficient(n: Int): Boolean = (sumDiv(n) <= n)
  def isAbundant(n: Int): Boolean = (sumDiv(n) > n)
  val abundantList: List[Int] = (for (i <- 12 to 28123; if (isAbundant(i))) yield i).toList // 6965 = List(12,,,,,28122)
  def cannot(n: Int): Boolean = {
    val abundantSubset: List[Int] = abundantList.filter(_ < n)
    for (i <- abundantSubset; j <- abundantSubset) if (i + j == n) return false
    //println(n)
    true
  }
  def p23: Int = {
    val cannotList: List[Int] = (for (i <- 1 to 28123; if (cannot(i))) yield i).toList
    val cannotSum: Int = cannotList.foldLeft(0)(_ + _)
    cannotSum
  }
  ignore("p23") { assert(p23 === 4179871) } // 160 seconds
  /**
   * **************************************************************************************************************
   * p24
   * What is the millionth lexicographic permutation of the digits 0, 1, 2, 3, 4, 5, 6, 7, 8 and 9?
   * http://projecteuler.net/problem=24
   * published 2002.08.16, updated 2012.09.18, solved by 41706 people, solved by me=false
   * ***************************************************************************************************************
   * A permutation is an ordered arrangement of objects. For example, 3124 is one possible permutation of the
   * digits 1, 2, 3 and 4. If all of the permutations are listed numerically or alphabetically, we call it lexicographic order.
   * The lexicographic permutations of 0, 1 and 2 are:
   * 012   021   102   120   201   210
   * What is the millionth lexicographic permutation of the digits 0, 1, 2, 3, 4, 5, 6, 7, 8 and 9?
   */
  def p24(n: Int, m: Int): String = {
    //List('a, 'b, 'c).permutations foreach println
    val listNums = (for (i <- 0 to n) yield i).toList
    val permList = (for (i <- listNums.permutations) yield i).toList
    //println("%d=%d".format(n, permList.length))
    permList(m - 1).foldLeft("")(_ + _)
  }

  test("p24.2.6") { assert(p24(2, 6) === "210") }
  ignore("p24.9.1000000") { assert(p24(9, 1000000) === "2783915460") } // 14 secs
  /**
   * **************************************************************************************************************
   * p25
   * What is the first term in the Fibonacci sequence to contain 1000 digits?
   * http://projecteuler.net/problem=25
   * published 2002.08.30, updated 2012.09.18, solved by 56608 people, solved by me=true
   * ***************************************************************************************************************
   * The Fibonacci sequence is defined by the recurrence relation:
   *
   * Fn = Fn1 + Fn2, where F1 = 1 and F2 = 1.
   * Hence the first 12 terms will be:
   *
   * F1 = 1
   * F2 = 1
   * F3 = 2
   * F4 = 3
   * F5 = 5
   * F6 = 8
   * F7 = 13
   * F8 = 21
   * F9 = 34
   * F10 = 55
   * F11 = 89
   * F12 = 144
   * The 12th term, F12, is the first term to contain three digits.
   *
   * What is the first term in the Fibonacci sequence to contain 1000 digits?
   */
  def p25(len: Int): Int = {
    for (ndx <- 1 until Int.MaxValue) {
      if (bigFibs(ndx).toString.length >= len) return ndx; 0
    }
    0
  }
  test("p25.3") { assert(p25(3) === 12) }
  test("p25.1K") { assert(p25(1000) === 4782) }

  /**
   * **************************************************************************************************************
   * p26
   * Find the value of <i>d</i> &lt; 1000 for which 1/<i>d</i> contains the longest recurring cycle.
   * http://projecteuler.net/problem=26
   * published 2002.09.13, updated 2012.09.18, solved by 29187 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p27
   * Find a quadratic formula that produces the maximum number of primes for consecutive values of <i>n</i>.
   * http://projecteuler.net/problem=27
   * published 2002.09.27, updated 2012.09.18, solved by 30797 people, solved by me=false
   * ***************************************************************************************************************
   * Euler published the remarkable quadratic formula:
   * n + n + 41
   * It turns out that the formula will produce 40 primes for the consecutive values n = 0 to 39.
   * However, when n = 40, 402 + 40 + 41 = 40(40 + 1) + 41 is divisible by 41, and certainly when n = 41, 41 + 41 + 41 is clearly divisible by 41.
   * Using computers, the incredible formula  n - 79n + 1601 was discovered, which produces 80 primes for the consecutive values n = 0 to 79.
   * The product of the coefficients, 79 and 1601, is 126479.
   * Considering quadratics of the form:
   * n + an + b, where |a| < 1000 and |b| < 1000
   * where |n| is the modulus/absolute value of n
   * e.g. |11| = 11 and |-4| = 4
   * Find the product of the coefficients, a and b, for the quadratic expression that produces the maximum number of
   * primes for consecutive values of n, starting with n = 0.
   */
  def p27(cMax: Int): (Int, Int, Int, Int) = {
    val coeffRange = -cMax to cMax
    def f(a: Int, b: Int, n: Int): Int = n * n + a * n + b

    def nPrimes(a: Int, b: Int): (Int, Int, Int, Int) = {
      var n = 0
      while (Primes.isPrime(f(a, b, n))) {
        n += 1
      }
      (a, b, n, a * b)
    }
    val ansList = (for (a <- coeffRange; b <- coeffRange) yield nPrimes(a, b)).toList
    import scala.math.max
    def findMax(i: Int, j: (Int, Int, Int, Int)): Int = max(i, j._3)
    val best = ansList.foldLeft(0)(findMax(_, _))
    ansList.filter(best == _._3).head
  }
  test("p27.9") { assert(p27(9) === (-3, 7, 6, -21)) }
  test("p27.99") { assert(p27(99) === (-15, 97, 48, -1455)) }
  //test("p27.999") { assert(p27(999) === (-61, 971, 71, -59231)) } // 5 secs
  /**
   * **************************************************************************************************************
   * p28
   * What is the sum of both diagonals in a 1001 by 1001 spiral?
   * http://projecteuler.net/problem=28
   * published 2002.10.11, updated 2012.09.18, solved by 43485 people, solved by me=true
   * ***************************************************************************************************************
   * Starting with the number 1 and moving to the right in a clockwise direction a 5 by 5 spiral is formed as follows:
   * 21 22 23 24 25
   * 20  7  8  9 10
   * 19  6  1  2 11
   * 18  5  4  3 12
   * 17 16 15 14 13
   * It can be verified that the sum of the numbers on the diagonals is 101.
   * What is the sum of the numbers on the diagonals in a 1001 by 1001 spiral formed in the same way?
   */
  /*    lazy val longFibs = { // Fibonacci stream of Longs
    def f(a: Long, b: Long): Stream[Long] = a #:: f(b, a + b)
    f(0, 1)
  }*/
  lazy val p28: Stream[Int] = {
    def fS(n: Int): Stream[Int] = fn(n) #:: fS(n + 1)
    def fn(n: Int): Int = p28(n - 2) + (4 * n * n - 6 * n + 6)
    0 #:: 1 #:: fS(2)
  }
  test("p28(5)") { assert(p28(5) === 101) }
  test("p28(1001)") { assert(p28(1001) === 669171001) }
  /**
   * **************************************************************************************************************
   * p29
   * How many distinct terms are in the sequence generated by a^b for 2 <= a <= 100 and 2 <= b <= 100?
   * http://projecteuler.net/problem=29
   * published 2002.10.25, updated 2012.09.18, solved by 37524 people, solved by me=false
   * ***************************************************************************************************************
   * Consider all integer combinations of a^b for 2 <= a <= 5 and 2 <= b <= 5:
   *
   * 2^2=4, 2^3=8, 2^4=16, 2^5=32
   * 3^2=9, 3^3=27, 3^4=81, 3^5=243
   * 4^2=16, 4^3=64, 4^4=256, 4^5=1024
   * 5^2=25, 5^3=125, 5^4=625, 5^5=3125
   * If they are then placed in numerical order, with any repeats removed, we get the following sequence of 15 distinct terms:
   *
   * 4, 8, 9, 16, 25, 27, 32, 64, 81, 125, 243, 256, 625, 1024, 3125
   *
   * How many distinct terms are in the sequence generated by a^b for 2 <= a <= 100 and 2 <= b <= 100?
   */
  def p29(n: Int): Int = {
    var resSet: Set[BigInt] = Set()
    for (i <- 2 to n; j <- 2 to n) resSet += BigInt(i.toString).pow(j)
    resSet.size
  }
  test("p29.5") { assert(p29(5) === 15) }
  test("p29.100") { assert(p29(100) === 9183) }
  /**
   * **************************************************************************************************************
   * p30
   * Find the sum of all the numbers that can be written as the sum of fifth powers of their digits.
   * http://projecteuler.net/problem=30
   * published 2002.11.08, updated 2012.09.18, solved by 40279 people, solved by me=false
   * ***************************************************************************************************************
   * Surprisingly there are only three numbers that can be written as the sum of fourth powers of their digits:
   * 1634 = 1^4 + 6^4 + 3^4 + 4^4
   * 8208 = 8^4 + 2^4 + 0^4 + 8^4
   * 9474 = 9^4 + 4^4 + 7^4 + 4^4
   * As 1 = 1^4 is not a sum it is not included.
   * The sum of these numbers is 1634 + 8208 + 9474 = 19316.
   * Find the sum of all the numbers that can be written as the sum of fifth powers of their digits.
   */
  def p30(exp: Int): Long = {
    def isMatch(n: Long): Boolean = {
      def sum(acc: List[BigInt], term: Long): List[BigInt] = {
        //println("sum(%s,%d)".format(acc, term))
        if (term == 0) acc
        else {
          val hi = term / 10
          val lo = term % 10
          val nextTerm = BigInt(lo.toString).pow(exp)
          sum(nextTerm :: acc, hi)
        }
      }
      val sumList = sum(List(), n)
      val foundMatch: Boolean = BigInt(n.toString) == sumList.foldLeft(BigInt("0"))(_ + _)
      //if (foundMatch) println("found %d=%s".format(n, sumList))
      foundMatch
    }
    val matchList: List[Long] = (for (i <- 1633L to 194980L; if isMatch(i)) yield i).toList
    matchList.foldLeft(0L)(_ + _)
  }
  test("p30.4") { assert(p30(4) === 19316L) }
  test("p30.5") { assert(p30(5) === 443839L) }
  /**
   * **************************************************************************************************************
   * p31
   * Investigating combinations of English currency denominations.
   * http://projecteuler.net/problem=31
   * published 2002.11.22, updated 2012.09.18, solved by 28449 people, solved by me=false
   * ***************************************************************************************************************
   *
   * In England the currency is made up of pound, , and pence, p, and there are eight coins in general circulation:
   * 1p, 2p, 5p, 10p, 20p, 50p, 1 (100p) and 2 (200p).
   * It is possible to make 2 in the following way:
   * 11 + 150p + 220p + 15p + 12p + 31p
   * How many different ways can 2 be made using any number of coins?
   */
  def countChange(money: Int, coins: List[Int]): Int = {
    //println("*******************************")
    def myCount1(acc: Int, goal: Int, coin: List[Int]): Int = {
      if (coin.isEmpty) acc
      else if (goal < coin.head) myCount1(acc, goal, coin.tail)
      else if (goal == coin.head) 1 + myCount1(acc, goal, coin.tail)
      else if (coin.tail.isEmpty) {
        if (0 == goal % coin.head) 1 + acc
        else acc
      } else myCount1(acc, goal, coin.tail) + myCount1(acc, goal - coin.head, coin)
    }

    def myCount2(acc: Int, goal: Int, coin: List[Int]): Int = {
      var total: Int = 0
      if (coin.isEmpty) 0 else {
        val i = 0
        if (goal < coin(i)) total += myCount2(0, goal, coin.tail) else {
          for (j <- 0 to goal / coin(i)) {
            if (0 == (goal - j * coin(i))) total += 1 else {
              total += myCount2(0, goal - j * coin(i), coin.tail)
            } // if
          } // for
        } // if
        total
      }
    } // def
    if (coins.isEmpty) 0 else { myCount1(0, money, coins) }
  }
  def p31(bigGoal: Int): Int = {
    val coins: List[Int] = List(200, 100, 50, 20, 10, 5, 2, 1)
    countChange(bigGoal, coins)
  }

  test("p31.200") { assert(p31(200) === 73682) }
  /**
   * **************************************************************************************************************
   * p32
   * Find the sum of all numbers that can be written as pandigital products.
   * http://projecteuler.net/problem=32
   * published 2002.12.06, updated 2012.09.18, solved by 25007 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p33
   * Discover all the fractions with an unorthodox cancelling method.
   * http://projecteuler.net/problem=33
   * published 2002.12.20, updated 2012.09.18, solved by 26416 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p34
   * Find the sum of all numbers which are equal to the sum of the factorial of their digits.
   * http://projecteuler.net/problem=34
   * published 2003.01.03, updated 2012.09.18, solved by 35539 people, solved by me=false
   * ***************************************************************************************************************
   * 145 is a curious number, as 1! + 4! + 5! = 1 + 24 + 120 = 145.
   * Find the sum of all numbers which are equal to the sum of the factorial of their digits.
   * Note: as 1! = 1 and 2! = 2 are not sums they are not included.
   */
  def factorial(n: Long) = (2L to n).foldLeft(1L)(_ * _)
  def p34(max: Int): Int = {
    def isMatch(n: Int): Boolean = n == n.toString.toList.map(_ - '0').map(factorial(_)).foldLeft(0L)(_ + _)
    val p34List: List[Int] = (for (i <- 9 to max; if isMatch(i)) yield i).toList
    p34List.foldLeft(0)(_ + _)
  }
  test("p34.40600") { assert(p34(40600) === 40730) } // 145+40585=40730
  /**
   * **************************************************************************************************************
   * p35
   * How many circular primes are there below one million?
   * http://projecteuler.net/problem=35
   * published 2003.01.17, updated 2012.09.18, solved by 32487 people, solved by me=false
   * ***************************************************************************************************************
   * The number, 197, is called a circular prime because all rotations of the digits: 197, 971, and 719, are themselves prime.
   * There are thirteen such primes below 100: 2, 3, 5, 7, 11, 13, 17, 31, 37, 71, 73, 79, and 97.
   * How many circular primes are there below one million?
   */
  def p35(n: Int): Int = {
    val myPrimes = Primes.primesBelow(n)
    def rotate(m: Int): List[String] = {
      def rot0(acc: List[String], num: String): List[String] = {
        if (acc.contains(num)) acc // all done (already did this num)
        else if (num.toInt < 10) List(num)
        else {
          val numList: List[Char] = num.toString.toList
          if (numList.contains('0')) List() // ignore this set because it contains a zero
          else {
            val nextNum: String = (numList.head :: (numList.tail.reverse)).reverse.foldLeft("")(_ + _)
            rot0(num :: acc, nextNum)
          }
        }
      }
      rot0(List(), m.toString)
    }
    def isCircular(p: Int): Boolean = {
      val rotListS: List[String] = rotate(p)
      if (rotListS.isEmpty) false
      else {
        val rotListI: List[Int] = rotListS.map(_.toInt)
        def toInt(in: String): Int = in.toInt
        rotListI.forall(Primes.isPrime(_))
      }
    }
    val circularPrimes = myPrimes.filter(isCircular(_))
    circularPrimes.length
  }
  test("p35.100") { assert(p35(100) === 13) }
  test("p35.1M") { assert(p35(1000000) === 55) }
  /**
   * **************************************************************************************************************
   * p36
   * Find the sum of all numbers less than one million, which are palindromic in base 10 and base 2.
   * http://projecteuler.net/problem=36
   * published 2003.01.31, updated 2012.09.18, solved by 35131 people, solved by me=false
   * ***************************************************************************************************************
   * The decimal number, 585 = 10010010012 (binary), is palindromic in both bases.
   * Find the sum of all numbers, less than one million, which are palindromic in base 10 and base 2.
   * (Please note that the palindromic number, in either base, may not include leading zeros.)
   */
  def p36(max: Int): Long = {
    def isDecimalPalindrome(n: Int): Boolean = {
      val nStr = n.toString
      nStr.reverse == nStr
    }
    def isBinaryPalindrome(n: Int): Boolean = {
      val nStr = Integer.toString(n, 2)
      nStr.reverse == nStr
    }
    val numList = (for (i <- 1 until max; if (isDecimalPalindrome(i) && isBinaryPalindrome(i))) yield i).toList
    numList.foldLeft(0)(_ + _)
  }
  test("p36.10") { assert(p36(10) === 25) }
  test("p36.1E6") { assert(p36(1000000) === 872187) }
  /**
   * **************************************************************************************************************
   * p37
   * Find the sum of all eleven primes that are both truncatable from left to right and right to left.
   * http://projecteuler.net/problem=37
   * published 2003.02.14, updated 2012.09.18, solved by 26995 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p38
   * What is the largest 1 to 9 pandigital that can be formed by multiplying a fixed number by 1, 2, 3, ... ?
   * http://projecteuler.net/problem=38
   * published 2003.02.28, updated 2012.09.18, solved by 22840 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p39
   * If <i>p</i> is the perimeter of a right angle triangle, {<i>a</i>, <i>b</i>, <i>c</i>}, which value, for <i>p</i> &le; 1000, has the most solutions?
   * http://projecteuler.net/problem=39
   * published 2003.03.14, updated 2012.09.18, solved by 26583 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p40
   * Finding the <i>n</i><sup>th</sup> digit of the fractional part of the irrational number.
   * http://projecteuler.net/problem=40
   * published 2003.03.28, updated 2012.09.18, solved by 30052 people, solved by me=false
   * ***************************************************************************************************************
   * An irrational decimal fraction is created by concatenating the positive integers:
   * 0.123456789101112131415161718192021...
   * It can be seen that the 12th digit of the fractional part is 1.
   * If dn represents the nth digit of the fractional part, find the value of the following expression.
   * d1 * d10 * d100 * d1000 * d10000 * d100000 * d1000000
   */
  def pow10(n: Int): Int = {
    if (n == 0) 1
    else 10 * (pow10(n - 1))
  }
  def p40(n: Int): Int = {
    lazy val charStream: Stream[Char] = {

      def loop(n: Int): Stream[Char] = {
        val curSeq: Stream[Char] = n.toString.toSeq.toStream
        curSeq #::: loop(n + 1)
      }
      loop(1)
    }

    val digList: List[Int] = {
      val chrs = for (i <- 0 to n) yield charStream(pow10(i) - 1) - '0'
      chrs.toList
    }
    digList.foldLeft(1)(_ * _)
  }
  test("p40.0") { assert(p40(0) === 1) }
  test("p40.1") { assert(p40(1) === 1) } //1.1
  test("p40.2") { assert(p40(2) === 5) } //1.1.5
  test("p40.3") { assert(p40(3) === 15) } //1.1.5.3
  test("p40.4") { assert(p40(4) === 105) } //1.1.5.3.7
  test("p40.5") { assert(p40(5) === 210) } //1.1.5.3.7.2
  test("p40.6") { assert(p40(6) === 210) } //1.1.5.3.7.2.1
  /**
   * **************************************************************************************************************
   * p41
   * What is the largest <i>n</i>-digit pandigital prime that exists?
   * http://projecteuler.net/problem=41
   * published 2003.04.11, updated 2012.09.18, solved by 24989 people, solved by me=false
   * ***************************************************************************************************************
   * We shall say that an n-digit number is pandigital if it makes use of all the digits 1 to n exactly once.
   * For example, 2143 is a 4-digit pandigital and is also prime.
   * What is the largest n-digit pandigital prime that exists?
   */
  def isPandigital(n: Int, m: Int): Boolean = {
    val nStr = n.toString
    def contains(d: Int): Boolean = {
      if (d < 1) true
      else (nStr.contains(d.toString.head)) && contains(d - 1)
    }
    contains(m)
  }
  def p41(maxDigit: Int): Int = {

    lazy val pandigitalPrimes: List[Int] = Primes.primesBelow(pow10(maxDigit)).filter(isPandigital(_, maxDigit))
    if (pandigitalPrimes.isEmpty) 0 else pandigitalPrimes.last
  }

  test("p41.4") { assert(p41(4) === 4231) }
  test("p41.7") { assert(p41(7) === 7652413) }
  ignore("p41.8") { assert(p41(8) === 0) } // 9 seconds
  ignore("p41.9") { assert(p41(9) === 4231) } // fail: out of heap space
  /**
   * **************************************************************************************************************
   * p42
   * How many triangle words does the list of common English words contain?
   * http://projecteuler.net/problem=42
   * published 2003.04.25, updated 2012.09.18, solved by 29525 people, solved by me=false
   * ***************************************************************************************************************
   */
  def p42: Int = {
    val wordList0: List[String] = Euler.loadFile(List("euler", "p42words.txt"))
    val wordList1 = wordList0(0).split(",")
    val wordList = wordList1 map (_.replace("\"", ""))
    def ft(n: Int): Stream[Int] = (n * (n + 1) / 2).toInt #:: ft(n + 1)
    lazy val triangle: Stream[Int] = 1 #:: ft(2)
    def isTriangleN(i: Int): Boolean = triangle.takeWhile(i >= _).contains(i)
    def chr2int(c: Char): Int = 1 + c.toLower - 'a'
    def isTrianglew(w: String): Boolean = {
      val chrs = w.toCharArray()
      val intArray = chrs.map(chr2int(_))
      val intsum = intArray.foldLeft(0)(_ + _)
      isTriangleN(intsum)
    }
    val twords = wordList.filter(isTrianglew(_))
    twords.length
  }
  test("p42") { assert(p42 === 162) }

  /**
   * **************************************************************************************************************
   * p43
   * Find the sum of all pandigital numbers with an unusual sub-string divisibility property.
   * http://projecteuler.net/problem=43
   * published 2003.05.09, updated 2012.09.18, solved by 20535 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p44
   * Find the smallest pair of pentagonal numbers whose sum and difference is pentagonal.
   * http://projecteuler.net/problem=44
   * published 2003.05.23, updated 2012.09.18, solved by 19992 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p45
   * After 40755, what is the next triangle number that is also pentagonal and hexagonal?
   * http://projecteuler.net/problem=45
   * published 2003.06.06, updated 2012.09.18, solved by 28205 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p46
   * What is the smallest odd composite that cannot be written as the sum of a prime and twice a square?
   * http://projecteuler.net/problem=46
   * published 2003.06.20, updated 2012.09.18, solved by 21015 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p47
   * Find the first four consecutive integers to have four distinct primes factors.
   * http://projecteuler.net/problem=47
   * published 2003.07.04, updated 2012.09.18, solved by 20813 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p48
   * Find the last ten digits of 1<sup>1</sup> + 2<sup>2</sup> + ... + 1000<sup>1000</sup>.
   * http://projecteuler.net/problem=48
   * published 2003.07.18, updated 2012.09.18, solved by 48909 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p49
   * Find arithmetic sequences, made of prime terms, whose four digits are permutations of each other.
   * http://projecteuler.net/problem=49
   * published 2003.08.01, updated 2012.09.18, solved by 20173 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p50
   * Which prime, below one-million, can be written as the sum of the most consecutive primes?
   * http://projecteuler.net/problem=50
   * published 2003.08.15, updated 2012.09.18, solved by 21843 people, solved by me=false
   * ***************************************************************************************************************
   * The prime 41, can be written as the sum of six consecutive primes:
   * 41 = 2 + 3 + 5 + 7 + 11 + 13
   * This is the longest sum of consecutive primes that adds to a prime below one-hundred.
   * The longest sum of consecutive primes below one-thousand that adds to a prime, contains 21 terms, and is equal to 953.
   * Which prime, below one-million, can be written as the sum of the most consecutive primes?
   */
  def p50(n: Int): (Int, Int, Int) = {
    val p = Primes.primesBelow(n)
    var savedLen: Int = 0
    var savedStart: Int = 0
    var savedSum: Int = 0
    for (startPos <- 0 until p.length; len <- 1 to p.length - startPos) {
      val sum = p.drop(startPos).take(len).foldLeft(0)(_ + _)
      if (p.contains(sum) && len > savedLen) { savedLen = len; savedStart = startPos; savedSum = sum }
    }
    (savedLen, savedStart, savedSum)
  }
  test("p50.1E2") { assert(p50(100) === (6, 0, 41)) }
  test("p50.1E3") { assert(p50(1000) === (21, 3, 953)) }
  ignore("P50.1E4") { assert(p50(10000) === (65, 1, 9521)) } // 29 secs
  ignore("P50.1E5") { assert(p50(100000) === (183, 1, 92951)) } // 3.79 hrs
  ignore("p50.1E6") { assert(p50(1000000) === (21, 1, 953)) } // 
  /**
   * **************************************************************************************************************
   * p51
   * Find the smallest prime which, by changing the same part of the number, can form eight different primes.
   * http://projecteuler.net/problem=51
   * published 2003.08.29, updated 2012.09.18, solved by 11346 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p52
   * Find the smallest positive integer, <i>x</i>, such that 2<i>x</i>, 3<i>x</i>, 4<i>x</i>, 5<i>x</i>, and 6<i>x</i>, contain the same digits in some order.
   * http://projecteuler.net/problem=52
   * published 2003.09.12, updated 2012.09.18, solved by 26997 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p53
   * How many values of C(<var>n</var>,<var>r</var>), for 1 &#8804; <var>n</var> &#8804; 100, exceed one-million?
   * http://projecteuler.net/problem=53
   * published 2003.09.26, updated 2012.09.18, solved by 24549 people, solved by me=false
   * ***************************************************************************************************************
   * There are exactly ten ways of selecting three from five, 12345:
   * 123, 124, 125, 134, 135, 145, 234, 235, 245, and 345
   * In combinatorics, we use the notation, 5C3 = 10.
   * In general,
   * nCr =	n! / r!(n-r)!    ,where r <= n
   * It is not until n = 23, that a value exceeds one-million: 23C10 = 1144066.
   * How many, not necessarily distinct, values of  nCr, for 1 <= n <= 100, are greater than one-million?
   */
  def factorial2(n: BigInt, result: BigInt): BigInt = if (n == 0) result else factorial2(n - 1, n * result)
  def p53(max: Int, threshold: Int): Int = {
    (for (n <- 1 to max) yield {
      val bnf = factorial2(n, 1)
      def over1m(n: Int, r: Int): Boolean = {
        val brf = factorial2(r, 1)
        val bnrf = factorial2(n - r, 1)
        val nCr = bnf / (brf * bnrf)
        nCr > threshold
      }
      (for (r <- 1 to n; if over1m(n, r)) yield 1).foldLeft(0)(_ + _)
    }).foldLeft(0)(_ + _)
  }
  test("p53.100") { assert(p53(100, 1000000) === 4075) }
  /**
   * **************************************************************************************************************
   * p54
   * How many hands did player one win in the game of poker?
   * http://projecteuler.net/problem=54
   * published 2003.10.10, updated 2012.09.18, solved by 12754 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p55
   * How many Lychrel numbers are there below ten-thousand?
   * http://projecteuler.net/problem=55
   * published 2003.10.24, updated 2012.09.18, solved by 21829 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p56
   * Considering natural numbers of the form, <i>a<sup>b</sup></i>, finding the maximum digital sum.
   * http://projecteuler.net/problem=56
   * published 2003.11.07, updated 2012.09.18, solved by 23132 people, solved by me=false
   * ***************************************************************************************************************
   * A googol (10^100) is a massive number: one followed by one-hundred zeros; 100^100 is almost unimaginably large:
   * one followed by two-hundred zeros. Despite their size, the sum of the digits in each number is only 1.
   * Considering natural numbers of the form, a^b, where a, b < 100, what is the maximum digital sum?
   */
  def p56(ceil: Int): Long = {
    def digSum(b: BigInt): Long = b.toString.length
    var maxSum = 0
    for (a <- 1 until ceil; b <- 1 until ceil) {
      val bi = BigInt(a).pow(b)
      def toInt(c: Char): Int = c - '0'
      val bs = bi.toString.toCharArray.map(toInt(_))
      val sum = bs.foldLeft(0)(_ + _)
      if (maxSum < sum) maxSum = sum
    }
    maxSum
  }
  test("p56.100") { assert(p56(100) === 972) }
  /**
   * **************************************************************************************************************
   * p57
   * Investigate the expansion of the continued fraction for the square root of two.
   * http://projecteuler.net/problem=57
   * published 2003.11.21, updated 2012.09.18, solved by 15412 people, solved by me=false
   * ***************************************************************************************************************
   * It is possible to show that the square root of two can be expressed as an infinite continued fraction.
   * 2 = 1 + 1/(2 + 1/(2 + 1/(2 + ... ))) = 1.414213...
   * By expanding this for the first four iterations, we get:
   * 1 + 1/2 = 3/2 = 1.5
   * 1 + 1/(2 + 1/2) = 7/5 = 1.4
   * 1 + 1/(2 + 1/(2 + 1/2)) = 17/12 = 1.41666...
   * 1 + 1/(2 + 1/(2 + 1/(2 + 1/2))) = 41/29 = 1.41379...
   * The next three expansions are 99/70, 239/169, and 577/408, but the eighth expansion, 1393/985,
   * is the first example where the number of digits in the numerator exceeds the number of digits in the denominator.
   * In the first one-thousand expansions, how many fractions contain a numerator with more digits than denominator?
   */
  def p57(max: Int): Int = max + 1
  test("p57.10") { assert(p57(10) === 10) }
  test("p57.100") { assert(p57(100) === 100) }
  test("p57.1000") { assert(p57(1000) === 1000) }
  /**
   * **************************************************************************************************************
   * p58
   * Investigate the number of primes that lie on the diagonals of the spiral grid.
   * http://projecteuler.net/problem=58
   * published 2003.12.05, updated 2012.09.18, solved by 15001 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p59
   * Using a brute force attack, can you decrypt the cipher using XOR encryption?
   * http://projecteuler.net/problem=59
   * published 2003.12.19, updated 2012.09.18, solved by 16389 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p60
   * Find a set of five primes for which any two primes concatenate to produce another prime.
   * http://projecteuler.net/problem=60
   * published 2004.01.02, updated 2012.09.18, solved by 9061 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p61
   * Find the sum of the only set of six 4-digit figurate numbers with a cyclic property.
   * http://projecteuler.net/problem=61
   * published 2004.01.16, updated 2012.09.18, solved by 9182 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p62
   * Find the smallest cube for which exactly five permutations of its digits are cube.
   * http://projecteuler.net/problem=62
   * published 2004.01.30, updated 2012.09.18, solved by 11365 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p63
   * How many <i>n</i>-digit positive integers exist which are also an <i>n</i><sup>th</sup> power?
   * http://projecteuler.net/problem=63
   * published 2004.02.13, updated 2012.09.18, solved by 16932 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p64
   * How many continued fractions for <var>N</var> &#8804; 10000 have an odd period?
   * http://projecteuler.net/problem=64
   * published 2004.02.27, updated 2012.09.18, solved by 8055 people, solved by me=false
   * ***************************************************************************************************************
   */
  test("p64") { assert(true === false) }
  /**
   * **************************************************************************************************************
   * p65
   * Find the sum of digits in the numerator of the 100<sup>th</sup> convergent of the continued fraction for <i>e</i>.
   * http://projecteuler.net/problem=65
   * published 2004.03.12, updated 2012.09.18, solved by 10969 people, solved by me=false
   * ***************************************************************************************************************
   */
  test("p65") { assert(true === false) }
  /**
   * **************************************************************************************************************
   * p66
   * Investigate the Diophantine equation <i>x</i><sup>2</sup> &#8722; D<i>y</i><sup>2</sup> = 1.
   * http://projecteuler.net/problem=66
   * published 2004.03.26, updated 2012.09.18, solved by 7217 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p67
   * Using an efficient algorithm find the maximal sum in the triangle?
   * http://projecteuler.net/problem=67
   * published 2004.04.09, updated 2012.09.18, solved by 38102 people, solved by me=true
   * ***************************************************************************************************************
   * By starting at the top of the triangle below and moving to adjacent numbers on the row below, the maximum total from top to bottom is 23.
   * 3
   * 7 4
   * 2 4 6
   * 8 5 9 3
   * That is, 3 + 7 + 4 + 9 = 23.
   * Find the maximum total from top to bottom in triangle.txt (right click and 'Save Link/Target As...'), a 15K text file containing a triangle with one-hundred rows.
   * NOTE: This is a much more difficult version of Problem 18. It is not possible to try every route to solve this problem,
   * as there are 299 altogether! If you could check one trillion (1012) routes every second it would take over twenty billion years to check them all.
   * There is an efficient algorithm to solve it. ;o)
   */
  def p1867(fileString: List[String]): Int = {
    val numList: List[String] = Euler.loadFile(fileString)
    val maxDim = numList.length
    val numArray: Array[Array[Int]] = Array.ofDim[Int](maxDim, maxDim)
    for (i <- 0 until maxDim) numArray(i) = numList(i).split(" ").toArray.map(_.toString.toInt)
    for (i <- (maxDim - 2) to 0 by -1; j <- 0 to i) {
      val left = numArray(i + 1)(j)
      val right = numArray(i + 1)(j + 1)
      if (left > right) (numArray(i)(j) += left) else (numArray(i)(j) += right)
    }
    numArray(0)(0)
  }
  def p67 = p1867(List("euler", "p67triangle.txt"))
  test("p67") { assert(p67 === 7273) }
  /**
   * **************************************************************************************************************
   * p68
   * What is the maximum 16-digit string for a "magic" 5-gon ring?
   * http://projecteuler.net/problem=68
   * published 2004.04.23, updated 2012.09.18, solved by 7519 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p69
   * Find the value of <i>n</i> &le; 1,000,000 for which <i>n</i>/&phi;(<i>n</i>) is a maximum.
   * http://projecteuler.net/problem=69
   * published 2004.05.07, updated 2012.09.18, solved by 13668 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p70
   * Investigate values of <var>n</var> for which &#966;(<var>n</var>) is a permutation of <var>n</var>.
   * http://projecteuler.net/problem=70
   * published 2004.05.21, updated 2012.09.18, solved by 8612 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p71
   * Listing reduced proper fractions in ascending order of size.
   * http://projecteuler.net/problem=71
   * published 2004.06.04, updated 2012.09.18, solved by 11501 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p72
   * How many elements would be contained in the set of reduced proper fractions for <i>d</i> &le; 1,000,000?
   * http://projecteuler.net/problem=72
   * published 2004.06.18, updated 2012.09.18, solved by 8602 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p73
   * How many fractions lie between 1/3 and 1/2 in a sorted set of reduced proper fractions?
   * http://projecteuler.net/problem=73
   * published 2004.07.02, updated 2012.10.25, solved by 10613 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p74
   * Determine the number of factorial chains that contain exactly sixty non-repeating terms.
   * http://projecteuler.net/problem=74
   * published 2004.07.16, updated 2012.09.18, solved by 10293 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p75
   * Find the number of different lengths of wire that can form a right angle triangle in only one way.
   * http://projecteuler.net/problem=75
   * published 2004.07.30, updated 2012.10.25, solved by 6649 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p76
   * How many different ways can one hundred be written as a sum of at least two positive integers?
   * http://projecteuler.net/problem=76
   * published 2004.08.13, updated 2012.09.18, solved by 11606 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p77
   * What is the first value which can be written as the sum of primes in over five thousand different ways?
   * http://projecteuler.net/problem=77
   * published 2004.08.27, updated 2012.09.18, solved by 6871 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p78
   * Investigating the number of ways in which coins can be separated into piles.
   * http://projecteuler.net/problem=78
   * published 2004.09.10, updated 2012.09.18, solved by 5981 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p79
   * By analysing a user's login attempts, can you determine the secret numeric passcode?
   * http://projecteuler.net/problem=79
   * published 2004.09.17, updated 2012.09.18, solved by 20254 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p80
   * Calculating the digital sum of the decimal digits of irrational square roots.
   * http://projecteuler.net/problem=80
   * published 2004.10.08, updated 2012.09.18, solved by 7609 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p81
   * Find the minimal path sum from the top left to the bottom right by moving right and down.
   * http://projecteuler.net/problem=81
   * published 2004.10.22, updated 2012.09.18, solved by 13381 people, solved by me=false
   * ***************************************************************************************************************
   * In the 5 by 5 matrix below, the minimal path sum from the top left to the bottom right, by only moving to the right and down,
   * is indicated in bold red and is equal to 2427.
   * 131	673	234	103	18
   * 201	96	342	965	150
   * 630	803	746	422	111
   * 537	699	497	121	956
   * 805	732	524	37	331
   * Find the minimal path sum, in matrix.txt (right click and 'Save Link/Target As...'), a 31K text file containing a 80 by 80 matrix,
   * from the top left to the bottom right by only moving right and down.
   */
  def arrayPrint(arr: Array[Array[Int]]): Unit = {
    for (i <- 0 until arr.length) { println(arr(i).toList) }
  }
  import scala.math.min
  def p81(n: Int): Int = {
    val fn: String = "p81matrix%dx%d.txt".format(n, n)
    val lineList: List[String] = Euler.loadFile(List("euler", fn))
    if (lineList.length != n) throw new Exception("lineCount=" + lineList.length)
    val numArray: Array[Array[Int]] = Array.fill(n, n)(0)
    for (l <- 0 until lineList.length) {
      val curLine = lineList(l)
      numArray(l) = curLine.split(",").map(_.toInt)
    }
    val ansArray: Array[Array[Int]] = Array.fill(n, n)(0)
    ansArray(0)(0) = numArray(0)(0)
    for (i <- 0 until n - 1) ansArray(0)(i + 1) = ansArray(0)(i) + numArray(0)(i + 1)
    for (j <- 0 until n - 1) ansArray(j + 1)(0) = ansArray(j)(0) + numArray(j + 1)(0)
    for (i <- 1 to n - 1; j <- 1 to n - 1) {
      ansArray(i)(j) = numArray(i)(j) + min(ansArray(i - 1)(j), ansArray(i)(j - 1))
    }
    ansArray(n - 1)(n - 1)
  }
  test("p81.5") { assert(p81(5) === 2427) }
  test("p81.80") { assert(p81(80) === 427337) }
  /**
   * **************************************************************************************************************
   * p82
   * Find the minimal path sum from the left column to the right column.
   * http://projecteuler.net/problem=82
   * published 2004.11.05, updated 2012.09.18, solved by 8073 people, solved by me=false
   * ***************************************************************************************************************
   * NOTE: This problem is a more challenging version of Problem 81.
   * The minimal path sum in the 5 by 5 matrix below, by starting in any cell in the left column and finishing in any cell in the right column,
   * and only moving up, down, and right, is indicated in red and bold; the sum is equal to 994.
   * 131 673 234 103 18
   * 201 96  342 965 150
   * 630 803 746 422 111
   * 537 699 497 121 956
   * 805 732 524 37  331
   * Find the minimal path sum, in matrix.txt (right click and 'Save Link/Target As...'), a 31K text file containing a 80 by 80 matrix,
   * from the left column to the right column.
   */

  /*  def p82(n: Int): Int = {
    val maxInt = Int.MaxValue
    val fn: String = "p81matrix%dx%d.txt".format(n, n)
    val lineList: List[String] = loadFile(List("euler", fn))

    if (lineList.length != n) throw new Exception("lineCount=" + lineList.length)
    val numArray: Array[Array[Int]] = Array.fill(n, n)(0)
    for (l <- 0 until lineList.length) {
      val curLine = lineList(l)
      numArray(l) = curLine.split(",").map(_.toInt)
    }
    val ansArray: Array[Array[Int]] = Array.fill(n, n)(0)
    for (i <- 0 until n) ansArray(i)(0) = numArray(i)(0)
    def calc(col: Int): Unit = {
      // this column is guaranteed not to be column 0
      // for each row, find least sum from col-1
      val tempArray1: Array[Int] = Array.fill(n)(maxInt)
      for (beg <- 0 until n; end <- 0 until n) {
        if (beg == end) tempArray1(end) = ansArray(beg)(col - 1) + numArray(end)(col)
        else {

          val crossStep: Int = if (beg < end) 1 else -1
          val crossRows: Int = if (beg < end) 1 + (end - beg) else 1 + (beg - end)
          val tempArray2: Array[Int] = Array.fill(crossRows)(maxInt)
          for (cross <- beg to end by crossStep) {
            // sum of ansArray(beg to cross)(col-1) plus sum of numArray(cross to end)(col)
            val leftsum: Int = (for (x <- beg to cross by crossStep) yield ansArray(x)(col)).foldLeft(0)(_ + _)
            val rightsum: Int = (for (x <- cross to end by crossStep) yield numArray(x)(col)).foldLeft(0)(_ + _)
            tempArray2(cross - min(beg, end)) = leftsum + rightsum
          }
          tempArray1(end) = tempArray2.foldLeft(maxInt)(min(_, _))
        }
        ansArray(end)(col) = tempArray1.foldLeft(maxInt)(min(_, _))
      }
    }
    def findLowest(fromCol: Int, toCol: Int): Unit = {
      if (fromCol == toCol || fromCol == (n - 1)) Unit
      else {
        calc(fromCol + 1)
        findLowest(fromCol + 1, toCol)
      }
    }
    findLowest(0, n - 1)
    var least: Int = maxInt
    for (i <- 0 until n) least = scala.math.min(least, ansArray(i)(n - 1))
    println(arrayPrint(ansArray))
    least
  }
  test("p82.5") { assert(p82(5) === 994) }
  //test("p82.80") { assert(p82(80) === 123) }
*/
  /**
   * **************************************************************************************************************
   * p83
   * Find the minimal path sum from the top left to the bottom right by moving left, right, up, and down.
   * http://projecteuler.net/problem=83
   * published 2004.11.19, updated 2012.09.18, solved by 6715 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p84
   * In the game, Monopoly, find the three most popular squares when using two 4-sided dice.
   * http://projecteuler.net/problem=84
   * published 2004.12.03, updated 2012.09.18, solved by 4625 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p85
   * Investigating the number of rectangles in a rectangular grid.
   * http://projecteuler.net/problem=85
   * published 2004.12.17, updated 2012.09.18, solved by 9853 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p86
   * Exploring the shortest path from one corner of a cuboid to another.
   * http://projecteuler.net/problem=86
   * published 2005.01.07, updated 2012.09.18, solved by 4659 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p87
   * Investigating numbers that can be expressed as the sum of a prime square, cube, and fourth power?
   * http://projecteuler.net/problem=87
   * published 2005.01.21, updated 2012.09.18, solved by 7992 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p88
   * Exploring minimal product-sum numbers for sets of different sizes.
   * http://projecteuler.net/problem=88
   * published 2005.02.04, updated 2012.09.18, solved by 3313 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p89
   * Develop a method to express Roman numerals in minimal form.
   * http://projecteuler.net/problem=89
   * published 2005.02.18, updated 2012.09.18, solved by 8072 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p90
   * An unexpected way of using two cubes to make a square.
   * http://projecteuler.net/problem=90
   * published 2005.03.04, updated 2012.09.18, solved by 3986 people, solved by me=false
   * ***************************************************************************************************************
   * "Because 90 is the sum of its unitary divisors (excluding itself), it is a unitary perfect number,
   * and because it is equal to the sum of a subset of its divisors, it is a semiperfect number. 90 is a pronic number.
   * But it is also a nontotient. It is a Perrin number, preceded in the sequence by 39, 51, 68."
   */
  /**
   * **************************************************************************************************************
   * p91
   * Find the number of right angle triangles in the quadrant.
   * http://projecteuler.net/problem=91
   * published 2005.03.18, updated 2012.09.18, solved by 5987 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p92
   * Investigating a square digits number chain with a surprising property.
   * http://projecteuler.net/problem=92
   * published 2005.04.01, updated 2012.09.18, solved by 16117 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p93
   * Using four distinct digits and the rules of arithmetic, find the longest sequence of target numbers.
   * http://projecteuler.net/problem=93
   * published 2005.04.15, updated 2012.09.18, solved by 4200 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p94
   * Investigating almost equilateral triangles with integral sides and area.
   * http://projecteuler.net/problem=94
   * published 2005.04.29, updated 2012.09.18, solved by 4439 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p95
   * Find the smallest member of the longest amicable chain with no element exceeding one million.
   * http://projecteuler.net/problem=95
   * published 2005.05.13, updated 2012.09.18, solved by 5219 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p96
   * Devise an algorithm for solving Su Doku puzzles.
   * http://projecteuler.net/problem=96
   * published 2005.05.27, updated 2012.09.18, solved by 6497 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p97
   * Find the last ten digits of the non-Mersenne prime: 28433 &times; 2<sup>7830457</sup> + 1.
   * http://projecteuler.net/problem=97
   * published 2005.06.10, updated 2012.09.18, solved by 21903 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p98
   * Investigating words, and their anagrams, which can represent square numbers.
   * http://projecteuler.net/problem=98
   * published 2005.06.17, updated 2012.09.18, solved by 4000 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p99
   * Which base/exponent pair in the file has the greatest numerical value?
   * http://projecteuler.net/problem=99
   * published 2005.07.01, updated 2012.09.18, solved by 12480 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p100
   * Finding the number of blue discs for which there is 50% chance of taking two blue.
   * http://projecteuler.net/problem=100
   * published 2005.07.15, updated 2012.09.18, solved by 5820 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p101
   * Investigate the optimum polynomial function to model the first <i>k</i> terms of a given sequence.
   * http://projecteuler.net/problem=101
   * published 2005.07.29, updated 2012.09.18, solved by 4015 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p102
   * For how many triangles in the text file does the interior contain the origin?
   * http://projecteuler.net/problem=102
   * published 2005.08.12, updated 2012.09.18, solved by 8918 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p103
   * Investigating sets with a special subset sum property.
   * http://projecteuler.net/problem=103
   * published 2005.08.26, updated 2012.09.18, solved by 3002 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p104
   * Finding Fibonacci numbers for which the first and last nine digits are pandigital.
   * http://projecteuler.net/problem=104
   * published 2005.09.09, updated 2012.09.18, solved by 6722 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p105
   * Find the sum of the special sum sets in the file.
   * http://projecteuler.net/problem=105
   * published 2005.09.23, updated 2012.09.18, solved by 3026 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p106
   * Find the minimum number of comparisons needed to identify special sum sets.
   * http://projecteuler.net/problem=106
   * published 2005.10.07, updated 2012.09.18, solved by 2411 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p107
   * Determining the most efficient way to connect the network.
   * http://projecteuler.net/problem=107
   * published 2005.10.21, updated 2012.09.18, solved by 4288 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p108
   * Solving the Diophantine equation 1/<var>x</var> + 1/<var>y</var> = 1/<var>n</var>.
   * http://projecteuler.net/problem=108
   * published 2005.11.04, updated 2012.09.18, solved by 5637 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p109
   * How many distinct ways can a player checkout in the game of darts with a score of less than 100?
   * http://projecteuler.net/problem=109
   * published 2005.11.18, updated 2012.09.18, solved by 3020 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p110
   * Find an efficient algorithm to analyse the number of solutions of the equation 1/<var>x</var> + 1/<var>y</var> = 1/<var>n</var>.
   * http://projecteuler.net/problem=110
   * published 2005.12.02, updated 2012.09.18, solved by 3516 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p111
   * Search for 10-digit primes containing the maximum number of repeated digits.
   * http://projecteuler.net/problem=111
   * published 2005.12.16, updated 2012.09.18, solved by 2870 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p112
   * Investigating the density of "bouncy" numbers.
   * http://projecteuler.net/problem=112
   * published 2005.12.30, updated 2012.09.18, solved by 9984 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p113
   * How many numbers below a googol (10<sup>100</sup>) are not &quot;bouncy&quot;?
   * http://projecteuler.net/problem=113
   * published 2006.02.10, updated 2012.09.18, solved by 4815 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p114
   * Investigating the number of ways to fill a row with separated blocks that are at least three units long.
   * http://projecteuler.net/problem=114
   * published 2006.02.17, updated 2012.09.18, solved by 4313 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p115
   * Finding a generalisation for the number of ways to fill a row with separated blocks.
   * http://projecteuler.net/problem=115
   * published 2006.02.24, updated 2012.09.18, solved by 3937 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p116
   * Investigating the number of ways of replacing square tiles with one of three coloured tiles.
   * http://projecteuler.net/problem=116
   * published 2006.03.03, updated 2012.09.18, solved by 4752 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p117
   * Investigating the number of ways of tiling a row using different-sized tiles.
   * http://projecteuler.net/problem=117
   * published 2006.03.10, updated 2012.09.18, solved by 4390 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p118
   * Exploring the number of ways in which sets containing prime elements can be made.
   * http://projecteuler.net/problem=118
   * published 2006.03.24, updated 2012.09.18, solved by 2587 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p119
   * Investigating the numbers which are equal to sum of their digits raised to some power.
   * http://projecteuler.net/problem=119
   * published 2006.04.07, updated 2012.09.18, solved by 4827 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p120
   * Finding the maximum remainder when (<i>a</i> &minus; 1)<sup><i>n</i></sup> + (<i>a</i> + 1)<sup><i>n</i></sup> is divided by <i>a</i><sup>2</sup>.
   * http://projecteuler.net/problem=120
   * published 2006.04.21, updated 2012.09.18, solved by 5856 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p121
   * Investigate the game of chance involving coloured discs.
   * http://projecteuler.net/problem=121
   * published 2006.05.19, updated 2012.09.18, solved by 3767 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p122
   * Finding the most efficient exponentiation method.
   * http://projecteuler.net/problem=122
   * published 2006.06.02, updated 2012.09.18, solved by 3133 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p123
   * Determining the remainder when (<i>p<sub>n</sub></i> &minus; 1)<sup><i>n</i></sup> + (<i>p<sub>n</sub></i> + 1)<sup><i>n</i></sup> is divided by <i>p<sub>n</sub></i><sup>2</sup>.
   * http://projecteuler.net/problem=123
   * published 2006.06.16, updated 2012.09.18, solved by 5024 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p124
   * Determining the <i>k</i><sup>th</sup> element of the sorted radical function.
   * http://projecteuler.net/problem=124
   * published 2006.07.14, updated 2012.09.18, solved by 6246 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p125
   * Finding square sums that are palindromic.
   * http://projecteuler.net/problem=125
   * published 2006.08.04, updated 2012.09.18, solved by 5854 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p126
   * Exploring the number of cubes required to cover every visible face on a cuboid.
   * http://projecteuler.net/problem=126
   * published 2006.08.18, updated 2012.09.18, solved by 1729 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p127
   * Investigating the number of <i>abc-hits</i> below a given limit.
   * http://projecteuler.net/problem=127
   * published 2006.09.01, updated 2012.10.25, solved by 2299 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p128
   * Which tiles in the hexagonal arrangement have prime differences with neighbours?
   * http://projecteuler.net/problem=128
   * published 2006.09.29, updated 2012.09.18, solved by 1897 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p129
   * Investigating minimal repunits that divide by <i>n</i>.
   * http://projecteuler.net/problem=129
   * published 2006.10.27, updated 2012.09.18, solved by 2546 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p130
   * Finding composite values, <i>n</i>, for which <i>n</i>&minus;1 is divisible by the length of the smallest repunits that divide it.
   * http://projecteuler.net/problem=130
   * published 2006.10.27, updated 2012.09.18, solved by 2412 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p131
   * Determining primes, <i>p</i>, for which <i>n</i><sup>3</sup> + <i>n</i><sup>2</sup><i>p</i> is a perfect cube.
   * http://projecteuler.net/problem=131
   * published 2006.11.10, updated 2012.09.18, solved by 3090 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p132
   * Determining the first forty prime factors of a very large repunit.
   * http://projecteuler.net/problem=132
   * published 2006.12.01, updated 2012.09.18, solved by 2689 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p133
   * Investigating which primes will never divide a repunit containing 10<sup><var>n</var></sup> digits.
   * http://projecteuler.net/problem=133
   * published 2006.12.01, updated 2012.09.18, solved by 2319 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p134
   * Finding the smallest positive integer related to any pair of consecutive primes.
   * http://projecteuler.net/problem=134
   * published 2006.12.15, updated 2012.09.18, solved by 2830 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p135
   * Determining the number of solutions of the equation <i>x</i><sup>2</sup> &minus; <i>y</i><sup>2</sup> &minus; <i>z</i><sup>2</sup> = <i>n</i>.
   * http://projecteuler.net/problem=135
   * published 2006.12.29, updated 2012.09.18, solved by 2568 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p136
   * Discover when the equation <i>x</i><sup>2</sup> &minus; <i>y</i><sup>2</sup> &minus; <i>z</i><sup>2</sup> = <i>n</i> has a unique solution.
   * http://projecteuler.net/problem=136
   * published 2006.12.29, updated 2012.09.18, solved by 2290 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p137
   * Determining the value of infinite polynomial series for which the coefficients are Fibonacci numbers.
   * http://projecteuler.net/problem=137
   * published 2007.01.12, updated 2012.09.18, solved by 2186 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p138
   * Investigating isosceles triangle for which the height and base length differ by one.
   * http://projecteuler.net/problem=138
   * published 2007.01.20, updated 2012.09.18, solved by 2454 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p139
   * Finding Pythagorean triangles which allow the square on the hypotenuse to be tiled.
   * http://projecteuler.net/problem=139
   * published 2007.01.27, updated 2012.09.18, solved by 2221 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p140
   * Investigating the value of infinite polynomial series for which the coefficients are a linear second order recurrence relation.
   * http://projecteuler.net/problem=140
   * published 2007.02.03, updated 2012.09.18, solved by 1707 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p141
   * Investigating progressive numbers, <i>n</i>, which are also square.
   * http://projecteuler.net/problem=141
   * published 2007.02.17, updated 2012.09.18, solved by 1479 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p142
   * Perfect Square Collection
   * http://projecteuler.net/problem=142
   * published 2007.02.23, updated 2012.09.18, solved by 2429 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p143
   * Investigating the Torricelli point of a triangle
   * http://projecteuler.net/problem=143
   * published 2007.03.02, updated 2012.10.25, solved by 1081 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p144
   * Investigating multiple reflections of a laser beam.
   * http://projecteuler.net/problem=144
   * published 2007.03.09, updated 2012.09.18, solved by 2124 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p145
   * How many reversible numbers are there below one-billion?
   * http://projecteuler.net/problem=145
   * published 2007.03.16, updated 2012.09.18, solved by 7028 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p146
   * Investigating a Prime Pattern
   * http://projecteuler.net/problem=146
   * published 2007.03.24, updated 2012.09.18, solved by 2060 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p147
   * Rectangles in cross-hatched grids
   * http://projecteuler.net/problem=147
   * published 2007.03.31, updated 2012.09.18, solved by 1194 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p148
   * Exploring Pascal's triangle.
   * http://projecteuler.net/problem=148
   * published 2007.04.06, updated 2012.09.18, solved by 2189 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p149
   * Searching for a maximum-sum subsequence.
   * http://projecteuler.net/problem=149
   * published 2007.04.13, updated 2012.09.18, solved by 1966 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p150
   * Searching a triangular array for a sub-triangle having minimum-sum.
   * http://projecteuler.net/problem=150
   * published 2007.04.13, updated 2012.09.18, solved by 1604 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p151
   * Paper sheets of standard sizes: an expected-value problem.
   * http://projecteuler.net/problem=151
   * published 2007.04.20, updated 2012.09.18, solved by 2165 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p152
   * Writing 1/2 as a sum of inverse squares
   * http://projecteuler.net/problem=152
   * published 2007.04.27, updated 2012.09.18, solved by 1096 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p153
   * Investigating Gaussian Integers
   * http://projecteuler.net/problem=153
   * published 2007.05.05, updated 2012.09.18, solved by 1049 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p154
   * Exploring Pascal&#39;s pyramid.
   * http://projecteuler.net/problem=154
   * published 2007.05.12, updated 2012.09.18, solved by 1106 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p155
   * Counting Capacitor Circuits.
   * http://projecteuler.net/problem=155
   * published 2007.05.18, updated 2012.09.18, solved by 1485 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p156
   * Counting Digits
   * http://projecteuler.net/problem=156
   * published 2007.05.25, updated 2012.09.18, solved by 997 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p157
   * Solving the diophantine equation <sup>1</sup>/<sub><var>a</var></sub>+<sup>1</sup>/<sub><var>b</var></sub>= <sup><var>p</var></sup>/<sub>10<sup><var>n</var></sup></sub>
   * http://projecteuler.net/problem=157
   * published 2007.06.01, updated 2012.09.18, solved by 1122 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p158
   * Exploring strings for which only one character comes lexicographically after its neighbour to the left.
   * http://projecteuler.net/problem=158
   * published 2007.06.15, updated 2012.09.18, solved by 1568 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p159
   * Digital root sums of factorisations.
   * http://projecteuler.net/problem=159
   * published 2007.06.30, updated 2012.09.18, solved by 1401 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p160
   * Factorial trailing digits
   * http://projecteuler.net/problem=160
   * published 2007.09.07, updated 2012.09.18, solved by 1387 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p161
   * Triominoes
   * http://projecteuler.net/problem=161
   * published 2007.09.21, updated 2012.09.18, solved by 896 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p162
   * Hexadecimal numbers
   * http://projecteuler.net/problem=162
   * published 2007.10.05, updated 2012.09.18, solved by 2487 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p163
   * Cross-hatched triangles
   * http://projecteuler.net/problem=163
   * published 2007.10.12, updated 2012.09.18, solved by 830 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p164
   * Numbers for which no three consecutive digits have a sum greater than a given value.
   * http://projecteuler.net/problem=164
   * published 2007.10.20, updated 2012.09.18, solved by 2571 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p165
   * Intersections
   * http://projecteuler.net/problem=165
   * published 2007.10.27, updated 2012.09.18, solved by 1120 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p166
   * Criss Cross
   * http://projecteuler.net/problem=166
   * published 2007.11.03, updated 2012.09.18, solved by 1786 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p167
   * Investigating Ulam sequences
   * http://projecteuler.net/problem=167
   * published 2007.11.09, updated 2012.09.18, solved by 753 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p168
   * Number Rotations
   * http://projecteuler.net/problem=168
   * published 2007.11.16, updated 2012.09.18, solved by 1168 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p169
   * Exploring the number of different ways a number can be expressed as a sum of powers of 2.
   * http://projecteuler.net/problem=169
   * published 2007.11.23, updated 2012.09.18, solved by 1913 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p170
   * Find the largest 0 to 9 pandigital that can be formed by concatenating products.
   * http://projecteuler.net/problem=170
   * published 2007.11.30, updated 2012.09.18, solved by 863 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p171
   * Finding numbers for which the sum of the squares of the digits is a square.
   * http://projecteuler.net/problem=171
   * published 2007.12.08, updated 2012.09.18, solved by 1088 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p172
   * Investigating numbers with few repeated digits.
   * http://projecteuler.net/problem=172
   * published 2007.12.15, updated 2012.09.18, solved by 1668 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p173
   * Using up to one million tiles how many different "hollow" square laminae can be formed?
   * http://projecteuler.net/problem=173
   * published 2007.12.22, updated 2012.09.18, solved by 4125 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p174
   * Counting the number of "hollow" square laminae that can form one, two, three, ... distinct arrangements.
   * http://projecteuler.net/problem=174
   * published 2007.12.22, updated 2012.09.18, solved by 2760 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p175
   * Fractions involving the number of different ways a number can be expressed as a sum of powers of 2.
   * http://projecteuler.net/problem=175
   * published 2007.12.28, updated 2012.09.18, solved by 847 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p176
   * Rectangular triangles that share a cathetus.
   * http://projecteuler.net/problem=176
   * published 2008.01.04, updated 2012.09.18, solved by 893 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p177
   * Integer angled Quadrilaterals.
   * http://projecteuler.net/problem=177
   * published 2008.01.11, updated 2012.09.18, solved by 596 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p178
   * Step Numbers
   * http://projecteuler.net/problem=178
   * published 2008.01.18, updated 2012.09.18, solved by 1539 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p179
   * Consecutive positive divisors
   * http://projecteuler.net/problem=179
   * published 2008.01.26, updated 2012.09.18, solved by 5207 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p180
   * Rational zeros of a function of three variables.
   * http://projecteuler.net/problem=180
   * published 2008.02.02, updated 2012.09.18, solved by 728 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p181
   * Investigating in how many ways objects of two different colours can be grouped.
   * http://projecteuler.net/problem=181
   * published 2008.02.09, updated 2012.09.18, solved by 846 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p182
   * RSA encryption
   * http://projecteuler.net/problem=182
   * published 2008.02.15, updated 2012.09.18, solved by 1165 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p183
   * Maximum product of parts
   * http://projecteuler.net/problem=183
   * published 2008.02.22, updated 2012.09.18, solved by 2305 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p184
   * Triangles containing the origin.
   * http://projecteuler.net/problem=184
   * published 2008.02.29, updated 2012.09.18, solved by 715 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p185
   * Number Mind
   * http://projecteuler.net/problem=185
   * published 2008.03.07, updated 2012.09.18, solved by 1409 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p186
   * Connectedness of a network.
   * http://projecteuler.net/problem=186
   * published 2008.03.15, updated 2012.09.18, solved by 1252 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p187
   * Semiprimes
   * http://projecteuler.net/problem=187
   * published 2008.03.22, updated 2012.09.18, solved by 5088 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p188
   * The hyperexponentiation of a number
   * http://projecteuler.net/problem=188
   * published 2008.04.04, updated 2012.09.18, solved by 3124 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p189
   * Tri-colouring a triangular grid
   * http://projecteuler.net/problem=189
   * published 2008.04.11, updated 2012.09.18, solved by 900 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p190
   * Maximising a weighted product
   * http://projecteuler.net/problem=190
   * published 2008.04.18, updated 2012.09.18, solved by 1904 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p191
   * Prize Strings
   * http://projecteuler.net/problem=191
   * published 2008.04.25, updated 2012.09.18, solved by 3255 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p192
   * Best Approximations
   * http://projecteuler.net/problem=192
   * published 2008.05.03, updated 2012.09.18, solved by 735 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p193
   * Squarefree Numbers
   * http://projecteuler.net/problem=193
   * published 2008.05.10, updated 2012.09.18, solved by 1405 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p194
   * Coloured Configurations
   * http://projecteuler.net/problem=194
   * published 2008.05.17, updated 2012.09.18, solved by 655 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p195
   * Inscribed circles of triangles with one angle of 60 degrees
   * http://projecteuler.net/problem=195
   * published 2008.05.23, updated 2012.09.18, solved by 623 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p196
   * Prime triplets
   * http://projecteuler.net/problem=196
   * published 2008.05.30, updated 2012.09.18, solved by 1048 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p197
   * Investigating the behaviour of a recursively defined sequence
   * http://projecteuler.net/problem=197
   * published 2008.06.06, updated 2012.09.18, solved by 2471 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p198
   * Ambiguous Numbers
   * http://projecteuler.net/problem=198
   * published 2008.06.13, updated 2012.09.18, solved by 541 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p199
   * Iterative Circle Packing
   * http://projecteuler.net/problem=199
   * published 2008.06.21, updated 2012.09.18, solved by 847 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p200
   * Find the 200th prime-proof sqube containing the contiguous sub-string "200"
   * http://projecteuler.net/problem=200
   * published 2008.06.28, updated 2012.09.18, solved by 1011 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p201
   * Subsets with a unique sum
   * http://projecteuler.net/problem=201
   * published 2008.07.05, updated 2012.09.18, solved by 1024 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p202
   * Laserbeam
   * http://projecteuler.net/problem=202
   * published 2008.07.05, updated 2012.09.18, solved by 1195 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p203
   * Squarefree Binomial Coefficients
   * http://projecteuler.net/problem=203
   * published 2008.09.06, updated 2012.09.18, solved by 4356 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p204
   * Generalised Hamming Numbers
   * http://projecteuler.net/problem=204
   * published 2008.09.06, updated 2012.09.18, solved by 3576 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p205
   * Dice Game
   * http://projecteuler.net/problem=205
   * published 2008.09.06, updated 2012.09.18, solved by 6820 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p206
   * Concealed Square
   * http://projecteuler.net/problem=206
   * published 2008.09.06, updated 2012.09.18, solved by 9763 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p207
   * Integer partition equations
   * http://projecteuler.net/problem=207
   * published 2008.09.06, updated 2012.09.18, solved by 2413 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p208
   * Robot Walks
   * http://projecteuler.net/problem=208
   * published 2008.09.12, updated 2012.09.18, solved by 848 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p209
   * Circular Logic
   * http://projecteuler.net/problem=209
   * published 2008.09.19, updated 2012.09.18, solved by 1256 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p210
   * Obtuse Angled Triangles
   * http://projecteuler.net/problem=210
   * published 2008.09.26, updated 2012.09.18, solved by 837 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p211
   * Divisor Square Sum
   * http://projecteuler.net/problem=211
   * published 2008.10.03, updated 2012.09.18, solved by 1767 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p212
   * Combined Volume of Cuboids
   * http://projecteuler.net/problem=212
   * published 2008.10.11, updated 2012.09.18, solved by 737 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p213
   * Flea Circus
   * http://projecteuler.net/problem=213
   * published 2008.10.18, updated 2012.09.18, solved by 1096 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p214
   * Totient Chains
   * http://projecteuler.net/problem=214
   * published 2008.10.25, updated 2012.09.18, solved by 2496 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p215
   * Crack-free Walls
   * http://projecteuler.net/problem=215
   * published 2008.10.31, updated 2012.09.18, solved by 1827 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p216
   * Investigating the primality of numbers of the form 2<var>n</var><sup>2</sup>-1
   * http://projecteuler.net/problem=216
   * published 2008.11.07, updated 2012.09.18, solved by 1921 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p217
   * Balanced Numbers
   * http://projecteuler.net/problem=217
   * published 2008.11.14, updated 2012.09.18, solved by 739 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p218
   * Perfect right-angled triangles
   * http://projecteuler.net/problem=218
   * published 2008.11.21, updated 2012.09.18, solved by 1459 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p219
   * Skew-cost coding
   * http://projecteuler.net/problem=219
   * published 2008.11.29, updated 2012.09.18, solved by 766 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p220
   * Heighway Dragon
   * http://projecteuler.net/problem=220
   * published 2008.12.06, updated 2012.09.18, solved by 1280 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p221
   * Alexandrian Integers
   * http://projecteuler.net/problem=221
   * published 2008.12.13, updated 2012.09.18, solved by 1025 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p222
   * Sphere Packing
   * http://projecteuler.net/problem=222
   * published 2008.12.19, updated 2012.09.18, solved by 1065 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p223
   * Almost right-angled triangles I
   * http://projecteuler.net/problem=223
   * published 2008.12.26, updated 2012.09.18, solved by 694 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p224
   * Almost right-angled triangles II
   * http://projecteuler.net/problem=224
   * published 2008.12.26, updated 2012.09.18, solved by 594 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p225
   * Tribonacci non-divisors
   * http://projecteuler.net/problem=225
   * published 2008.12.26, updated 2012.09.18, solved by 2099 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p226
   * A Scoop of Blancmange
   * http://projecteuler.net/problem=226
   * published 2009.01.02, updated 2012.09.18, solved by 940 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p227
   * The Chase
   * http://projecteuler.net/problem=227
   * published 2009.01.09, updated 2012.09.18, solved by 979 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p228
   * Minkowski Sums
   * http://projecteuler.net/problem=228
   * published 2009.01.17, updated 2012.09.18, solved by 739 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p229
   * Four Representations using Squares
   * http://projecteuler.net/problem=229
   * published 2009.01.24, updated 2012.09.18, solved by 734 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p230
   * Fibonacci Words
   * http://projecteuler.net/problem=230
   * published 2009.01.31, updated 2012.09.18, solved by 1564 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p231
   * The prime factorisation of binomial coefficients
   * http://projecteuler.net/problem=231
   * published 2009.02.06, updated 2012.09.18, solved by 2664 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p232
   * The Race
   * http://projecteuler.net/problem=232
   * published 2009.02.13, updated 2012.09.18, solved by 877 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p233
   * Lattice points on a circle
   * http://projecteuler.net/problem=233
   * published 2009.02.20, updated 2012.09.18, solved by 799 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p234
   * Semidivisible numbers
   * http://projecteuler.net/problem=234
   * published 2009.02.27, updated 2012.09.18, solved by 1778 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p235
   * An Arithmetic Geometric sequence
   * http://projecteuler.net/problem=235
   * published 2009.03.07, updated 2012.09.18, solved by 2709 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p236
   * Luxury Hampers
   * http://projecteuler.net/problem=236
   * published 2009.03.14, updated 2012.09.18, solved by 530 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p237
   * Tours on a 4 x n playing board
   * http://projecteuler.net/problem=237
   * published 2009.03.21, updated 2012.09.18, solved by 790 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p238
   * Infinite string tour
   * http://projecteuler.net/problem=238
   * published 2009.03.29, updated 2012.09.18, solved by 555 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p239
   * Twenty-two Foolish Primes
   * http://projecteuler.net/problem=239
   * published 2009.04.03, updated 2012.09.18, solved by 937 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p240
   * Top Dice
   * http://projecteuler.net/problem=240
   * published 2009.04.10, updated 2012.09.18, solved by 1136 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p241
   * Perfection Quotients
   * http://projecteuler.net/problem=241
   * published 2009.04.17, updated 2012.09.18, solved by 500 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p242
   * Odd Triplets
   * http://projecteuler.net/problem=242
   * published 2009.04.25, updated 2012.09.18, solved by 567 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p243
   * Resilience
   * http://projecteuler.net/problem=243
   * published 2009.05.02, updated 2012.09.18, solved by 3096 people, solved by me=false
   * ***************************************************************************************************************
   * Find the smallest denominator d, having a resilience R(d) < 15499/94744 .
   */
  class BigRat(val n: BigInt, val d: BigInt) {
    def gcd(a: BigInt, b: BigInt): BigInt = if (b == 0) a.abs else gcd(b, a % b)
    val g = gcd(n, d)
    val num: BigInt = n / g
    val den: BigInt = d / g
    val isResilient: Boolean = (n == num)
    def <(that: BigRat): Boolean = (this.num * that.den) < (that.num * this.den)
    override def toString: String = "(%s/%s)".format(num, den)
  }
  class LongRat(val n: Long, val d: Long) {
    def gcd(a: Long, b: Long): Long = if (b == 0) a.abs else gcd(b, a % b)
    val g = gcd(n, d)
    val num: Long = n / g
    val den: Long = d / g
    val isResilient: Boolean = (n == num)
    def <(that: LongRat): Boolean = (this.num * that.den) < (that.num * this.den)
    override def toString: String = "(%s/%s)".format(num, den)
  }
  class IntRat(val n: Int, val d: Int) {
    def gcd(a: Int, b: Int): Int = if (b == 0) a.abs else gcd(b, a % b)
    val g = gcd(n, d)
    val num: Int = n / g
    val den: Int = d / g
    val isResilient: Boolean = (n == num)
    def <(that: IntRat): Boolean = (this.num * that.den) < (that.num * this.den)
    override def toString: String = "(%s/%s)".format(num, den)
  }
  def p243(start: Int, goal: LongRat): Int = {
    def r(n: Int): LongRat = {
      val resilientList = (for (i <- 2 until n; if ((new IntRat(i, n)).isResilient)) yield i).toList
      val resilientCount = 1 + resilientList.length
      new LongRat(resilientCount, n - 1)
    }
    for (i <- start until Int.MaxValue) if (r(i) < goal) return i
    0
  }
  // FIXME TODO
  test("p243.4/10") { assert(p243(2, new LongRat(4, 10)) === 12) }
  test("p243.1/3") { assert(p243(2, new LongRat(1, 3)) === 30) }
  test("p243.1/4") { assert(p243(2, new LongRat(1, 4)) === 210) }
  test("p243.1/5") { assert(p243(30000, new LongRat(1, 5)) === 30030) }
  test("p243.190/1000") { assert(p243(510500, new LongRat(190, 1000)) === 510510) }
  ignore("p243.18051/100000") { assert(p243(510500, new LongRat(18051, 100000)) === 510506) }
  ignore("p243.180/1000") { assert(p243(510500, new LongRat(180, 1000)) === 510510) }
  ignore("p243.175/1000") { assert(p243(510500, new LongRat(175, 1000)) === 210) }
  ignore("p243.170/1000") { assert(p243(510500, new LongRat(170, 1000)) === 210) }
  ignore("p243.165/1000") { assert(p243(510500, new LongRat(165, 1000)) === 210) }
  ignore("p243.15499/94744") { assert(p243(510500, new LongRat(15499, 94744)) === 12) } // 0.1635881955585578
  def p243a(): Unit = {
    var k = 510500
    for (j <- 18052 to 16357 by -1) {
      val goal = new LongRat(j, 100000)
      val nextK = p243(k, goal)
      println("p243(%d,%s)=%d".format(k, goal, nextK))
      if (nextK == 0) return // failed to find
      k = nextK - 1
    }
  }
  ignore("p243a") {
    p243a
    assert(true == true)
  }

  /**
   * **************************************************************************************************************
   * p244
   * Sliders
   * http://projecteuler.net/problem=244
   * published 2009.05.09, updated 2012.09.18, solved by 686 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p245
   * Coresilience
   * http://projecteuler.net/problem=245
   * published 2009.05.15, updated 2012.10.25, solved by 455 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p246
   * Tangents to an ellipse
   * http://projecteuler.net/problem=246
   * published 2009.05.22, updated 2012.09.18, solved by 459 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p247
   * Squares under a hyperbola
   * http://projecteuler.net/problem=247
   * published 2009.05.29, updated 2012.09.18, solved by 789 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p248
   * Numbers for which Euler셲 totient function equals 13!
   * http://projecteuler.net/problem=248
   * published 2009.06.05, updated 2012.09.18, solved by 651 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p249
   * Prime Subset Sums
   * http://projecteuler.net/problem=249
   * published 2009.06.13, updated 2012.09.18, solved by 1123 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p250
   * 250250
   * http://projecteuler.net/problem=250
   * published 2009.06.13, updated 2012.09.18, solved by 1271 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p251
   * Cardano Triplets
   * http://projecteuler.net/problem=251
   * published 2009.06.20, updated 2012.10.25, solved by 662 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p252
   * Convex Holes
   * http://projecteuler.net/problem=252
   * published 2009.06.27, updated 2012.09.18, solved by 512 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p253
   * Tidying up
   * http://projecteuler.net/problem=253
   * published 2009.08.28, updated 2012.09.18, solved by 521 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p254
   * Sums of Digit Factorials
   * http://projecteuler.net/problem=254
   * published 2009.09.04, updated 2012.09.18, solved by 536 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p255
   * Rounded Square Roots
   * http://projecteuler.net/problem=255
   * published 2009.09.11, updated 2012.09.18, solved by 507 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p256
   * Tatami-Free Rooms
   * http://projecteuler.net/problem=256
   * published 2009.09.18, updated 2012.09.18, solved by 431 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p257
   * Angular Bisectors
   * http://projecteuler.net/problem=257
   * published 2009.09.26, updated 2012.09.18, solved by 396 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p258
   * A lagged Fibonacci sequence
   * http://projecteuler.net/problem=258
   * published 2009.10.03, updated 2012.09.18, solved by 712 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p259
   * Reachable Numbers
   * http://projecteuler.net/problem=259
   * published 2009.10.10, updated 2012.09.18, solved by 721 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p260
   * Stone Game
   * http://projecteuler.net/problem=260
   * published 2009.10.16, updated 2012.09.18, solved by 678 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p261
   * Pivotal Square Sums
   * http://projecteuler.net/problem=261
   * published 2009.10.23, updated 2012.09.18, solved by 393 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p262
   * Mountain Range.
   * http://projecteuler.net/problem=262
   * published 2009.10.30, updated 2012.09.18, solved by 433 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p263
   * An engineers' dream come true
   * http://projecteuler.net/problem=263
   * published 2009.11.06, updated 2012.09.18, solved by 560 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p264
   * Triangle Centres
   * http://projecteuler.net/problem=264
   * published 2009.11.14, updated 2012.09.18, solved by 375 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p265
   * Binary Circles
   * http://projecteuler.net/problem=265
   * published 2009.11.21, updated 2012.09.18, solved by 2004 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p266
   * Pseudo Square Root
   * http://projecteuler.net/problem=266
   * published 2009.11.28, updated 2012.09.18, solved by 771 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p267
   * Billionaire
   * http://projecteuler.net/problem=267
   * published 2009.12.04, updated 2012.09.18, solved by 1439 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p268
   * Counting numbers with at least four distinct prime factors less than 100
   * http://projecteuler.net/problem=268
   * published 2009.12.11, updated 2012.09.18, solved by 701 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p269
   * Polynomials with at least one integer root
   * http://projecteuler.net/problem=269
   * published 2009.12.19, updated 2012.09.18, solved by 400 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p270
   * Cutting Squares
   * http://projecteuler.net/problem=270
   * published 2009.12.25, updated 2012.09.18, solved by 407 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p271
   * Modular Cubes, part 1
   * http://projecteuler.net/problem=271
   * published 2010.01.02, updated 2012.09.18, solved by 1008 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p272
   * Modular Cubes, part 2
   * http://projecteuler.net/problem=272
   * published 2010.01.02, updated 2012.09.18, solved by 449 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p273
   * Sum of Squares
   * http://projecteuler.net/problem=273
   * published 2010.01.09, updated 2012.09.18, solved by 669 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p274
   * Divisibility Multipliers
   * http://projecteuler.net/problem=274
   * published 2010.01.15, updated 2012.09.18, solved by 774 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p275
   * Balanced Sculptures
   * http://projecteuler.net/problem=275
   * published 2010.01.22, updated 2012.09.18, solved by 385 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p276
   * Primitive Triangles
   * http://projecteuler.net/problem=276
   * published 2010.01.29, updated 2012.09.18, solved by 545 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p277
   * A Modified Collatz sequence
   * http://projecteuler.net/problem=277
   * published 2010.02.05, updated 2012.09.18, solved by 1479 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p278
   * Linear Combinations of Semiprimes
   * http://projecteuler.net/problem=278
   * published 2010.02.13, updated 2012.09.18, solved by 511 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p279
   * Triangles with integral sides and an integral angle
   * http://projecteuler.net/problem=279
   * published 2010.02.20, updated 2012.09.18, solved by 395 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p280
   * Ant and seeds
   * http://projecteuler.net/problem=280
   * published 2010.02.27, updated 2012.09.18, solved by 517 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p281
   * Pizza Toppings
   * http://projecteuler.net/problem=281
   * published 2010.03.05, updated 2012.09.18, solved by 470 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p282
   * The Ackermann function
   * http://projecteuler.net/problem=282
   * published 2010.03.12, updated 2012.09.18, solved by 516 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p283
   * Integer sided triangles for which the  area/perimeter ratio is integral.
   * http://projecteuler.net/problem=283
   * published 2010.03.19, updated 2012.09.18, solved by 397 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p284
   * Steady Squares
   * http://projecteuler.net/problem=284
   * published 2010.03.26, updated 2012.09.18, solved by 644 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p285
   * Pythagorean odds
   * http://projecteuler.net/problem=285
   * published 2010.04.03, updated 2012.09.18, solved by 612 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p286
   * Scoring probabilities
   * http://projecteuler.net/problem=286
   * published 2010.04.03, updated 2012.09.18, solved by 934 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p287
   * Quadtree encoding (a simple compression algorithm)
   * http://projecteuler.net/problem=287
   * published 2010.04.10, updated 2012.09.18, solved by 708 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p288
   * An enormous factorial
   * http://projecteuler.net/problem=288
   * published 2010.04.17, updated 2012.09.18, solved by 596 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p289
   * Eulerian Cycles
   * http://projecteuler.net/problem=289
   * published 2010.04.23, updated 2012.09.18, solved by 334 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p290
   * Digital Signature
   * http://projecteuler.net/problem=290
   * published 2010.04.30, updated 2012.09.18, solved by 526 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p291
   * Panaitopol Primes
   * http://projecteuler.net/problem=291
   * published 2010.05.07, updated 2012.09.18, solved by 628 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p292
   * Pythagorean Polygons
   * http://projecteuler.net/problem=292
   * published 2010.05.14, updated 2012.09.18, solved by 367 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p293
   * Pseudo-Fortunate Numbers
   * http://projecteuler.net/problem=293
   * published 2010.05.22, updated 2012.09.18, solved by 1126 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p294
   * Sum of digits - experience #23
   * http://projecteuler.net/problem=294
   * published 2010.05.29, updated 2012.09.18, solved by 467 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p295
   * Lenticular holes
   * http://projecteuler.net/problem=295
   * published 2010.06.05, updated 2012.09.18, solved by 329 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p296
   * Angular Bisector and Tangent
   * http://projecteuler.net/problem=296
   * published 2010.06.11, updated 2012.09.18, solved by 352 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p297
   * Zeckendorf Representation
   * http://projecteuler.net/problem=297
   * published 2010.06.18, updated 2012.09.18, solved by 1314 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p298
   * Selective Amnesia
   * http://projecteuler.net/problem=298
   * published 2010.06.25, updated 2012.09.18, solved by 393 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p299
   * Three similar triangles
   * http://projecteuler.net/problem=299
   * published 2010.07.02, updated 2012.09.18, solved by 392 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p300
   * Protein folding
   * http://projecteuler.net/problem=300
   * published 2010.09.04, updated 2012.09.18, solved by 507 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p301
   * Nim
   * http://projecteuler.net/problem=301
   * published 2010.09.11, updated 2012.09.18, solved by 2138 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p302
   * Strong Achilles Numbers
   * http://projecteuler.net/problem=302
   * published 2010.09.18, updated 2012.09.18, solved by 385 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p303
   * Multiples with small digits
   * http://projecteuler.net/problem=303
   * published 2010.09.25, updated 2012.09.18, solved by 1559 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p304
   * Primonacci
   * http://projecteuler.net/problem=304
   * published 2010.10.02, updated 2012.09.18, solved by 856 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p305
   * Reflexive Position
   * http://projecteuler.net/problem=305
   * published 2010.10.09, updated 2012.09.18, solved by 376 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p306
   * Paper-strip Game
   * http://projecteuler.net/problem=306
   * published 2010.10.17, updated 2012.09.18, solved by 548 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p307
   * Chip Defects
   * http://projecteuler.net/problem=307
   * published 2010.10.24, updated 2012.09.18, solved by 692 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p308
   * An amazing Prime-generating Automaton
   * http://projecteuler.net/problem=308
   * published 2010.10.30, updated 2012.09.18, solved by 426 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p309
   * Integer Ladders
   * http://projecteuler.net/problem=309
   * published 2010.11.06, updated 2012.09.18, solved by 400 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p310
   * Nim Square
   * http://projecteuler.net/problem=310
   * published 2010.11.13, updated 2012.09.18, solved by 469 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p311
   * Biclinic Integral Quadrilaterals
   * http://projecteuler.net/problem=311
   * published 2010.11.20, updated 2012.09.18, solved by 278 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p312
   * Cyclic paths on Sierpi&#324;ski graphs
   * http://projecteuler.net/problem=312
   * published 2010.11.27, updated 2012.09.18, solved by 426 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p313
   * Sliding game
   * http://projecteuler.net/problem=313
   * published 2010.12.04, updated 2012.09.18, solved by 595 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p314
   * The Mouse on the Moon
   * http://projecteuler.net/problem=314
   * published 2010.12.12, updated 2012.09.18, solved by 297 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p315
   * Digital root clocks
   * http://projecteuler.net/problem=315
   * published 2010.12.19, updated 2012.09.18, solved by 1069 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p316
   * Numbers in decimal expansions
   * http://projecteuler.net/problem=316
   * published 2010.12.25, updated 2012.09.18, solved by 350 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p317
   * Firecracker
   * http://projecteuler.net/problem=317
   * published 2011.01.01, updated 2012.09.18, solved by 966 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p318
   * 2011 nines
   * http://projecteuler.net/problem=318
   * published 2011.01.01, updated 2012.09.18, solved by 438 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p319
   * Bounded Sequences
   * http://projecteuler.net/problem=319
   * published 2011.01.08, updated 2012.09.18, solved by 249 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p320
   * Factorials divisible by a huge integer
   * http://projecteuler.net/problem=320
   * published 2011.01.15, updated 2012.09.18, solved by 377 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p321
   * Swapping Counters
   * http://projecteuler.net/problem=321
   * published 2011.01.22, updated 2012.09.18, solved by 700 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p322
   * Binomial coefficients divisible by 10
   * http://projecteuler.net/problem=322
   * published 2011.01.29, updated 2012.09.18, solved by 264 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p323
   * Bitwise-OR operations on random integers
   * http://projecteuler.net/problem=323
   * published 2011.02.06, updated 2012.09.18, solved by 1195 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p324
   * Building a tower
   * http://projecteuler.net/problem=324
   * published 2011.02.13, updated 2012.09.18, solved by 333 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p325
   * Stone Game II
   * http://projecteuler.net/problem=325
   * published 2011.02.19, updated 2012.09.18, solved by 296 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p326
   * Modulo Summations
   * http://projecteuler.net/problem=326
   * published 2011.02.26, updated 2012.09.18, solved by 296 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p327
   * Rooms of Doom
   * http://projecteuler.net/problem=327
   * published 2011.03.05, updated 2012.09.18, solved by 525 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p328
   * Lowest-cost Search
   * http://projecteuler.net/problem=328
   * published 2011.03.12, updated 2012.09.18, solved by 239 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p329
   * Prime Frog
   * http://projecteuler.net/problem=329
   * published 2011.03.19, updated 2012.09.18, solved by 846 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p330
   * Euler's Number
   * http://projecteuler.net/problem=330
   * published 2011.03.27, updated 2012.09.18, solved by 281 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p331
   * Cross flips
   * http://projecteuler.net/problem=331
   * published 2011.04.03, updated 2012.09.18, solved by 224 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p332
   * Spherical triangles
   * http://projecteuler.net/problem=332
   * published 2011.04.10, updated 2012.09.18, solved by 320 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p333
   * Special partitions
   * http://projecteuler.net/problem=333
   * published 2011.04.16, updated 2012.09.18, solved by 480 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p334
   * Spilling the beans
   * http://projecteuler.net/problem=334
   * published 2011.04.23, updated 2012.09.18, solved by 264 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p335
   * Gathering the beans
   * http://projecteuler.net/problem=335
   * published 2011.04.23, updated 2012.09.18, solved by 263 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p336
   * Maximix Arrangements
   * http://projecteuler.net/problem=336
   * published 2011.04.30, updated 2012.09.18, solved by 646 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p337
   * Totient Stairstep Sequences
   * http://projecteuler.net/problem=337
   * published 2011.05.07, updated 2012.09.18, solved by 266 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p338
   * Cutting Rectangular Grid Paper
   * http://projecteuler.net/problem=338
   * published 2011.05.14, updated 2012.09.18, solved by 222 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p339
   * Peredur fab Efrawg
   * http://projecteuler.net/problem=339
   * published 2011.05.21, updated 2012.09.18, solved by 301 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p340
   * Crazy Function
   * http://projecteuler.net/problem=340
   * published 2011.05.29, updated 2012.09.18, solved by 405 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p341
   * Golomb's self-describing sequence
   * http://projecteuler.net/problem=341
   * published 2011.06.05, updated 2012.09.18, solved by 455 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p342
   * The totient of a square is a cube
   * http://projecteuler.net/problem=342
   * published 2011.06.11, updated 2012.09.18, solved by 383 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p343
   * Fractional Sequences
   * http://projecteuler.net/problem=343
   * published 2011.06.18, updated 2012.09.18, solved by 670 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p344
   * Silver dollar game
   * http://projecteuler.net/problem=344
   * published 2011.06.25, updated 2012.09.18, solved by 137 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p345
   * Matrix Sum
   * http://projecteuler.net/problem=345
   * published 2011.09.03, updated 2012.09.18, solved by 1367 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p346
   * Strong Repunits
   * http://projecteuler.net/problem=346
   * published 2011.09.03, updated 2012.09.18, solved by 985 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p347
   * Largest integer divisible by two primes
   * http://projecteuler.net/problem=347
   * published 2011.09.03, updated 2012.09.18, solved by 972 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p348
   * Sum of a square and a cube
   * http://projecteuler.net/problem=348
   * published 2011.09.03, updated 2012.09.18, solved by 846 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p349
   * Langton's ant
   * http://projecteuler.net/problem=349
   * published 2011.09.03, updated 2012.09.18, solved by 723 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p350
   * Constraining the least greatest and the greatest least
   * http://projecteuler.net/problem=350
   * published 2011.09.10, updated 2012.09.18, solved by 245 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p351
   * Hexagonal orchards
   * http://projecteuler.net/problem=351
   * published 2011.09.17, updated 2012.09.18, solved by 877 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p352
   * Blood tests
   * http://projecteuler.net/problem=352
   * published 2011.10.01, updated 2012.09.18, solved by 307 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p353
   * Risky moon
   * http://projecteuler.net/problem=353
   * published 2011.10.08, updated 2012.09.18, solved by 246 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p354
   * Distances in a bee's honeycomb
   * http://projecteuler.net/problem=354
   * published 2011.10.16, updated 2012.09.18, solved by 202 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p355
   * Maximal coprime subset
   * http://projecteuler.net/problem=355
   * published 2011.10.23, updated 2012.09.18, solved by 294 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p356
   * Largest roots of cubic polynomials
   * http://projecteuler.net/problem=356
   * published 2011.10.29, updated 2012.09.18, solved by 276 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p357
   * Prime generating integers
   * http://projecteuler.net/problem=357
   * published 2011.11.05, updated 2012.09.18, solved by 1687 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p358
   * Cyclic numbers
   * http://projecteuler.net/problem=358
   * published 2011.11.12, updated 2012.09.18, solved by 613 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p359
   * Hilbert's New Hotel
   * http://projecteuler.net/problem=359
   * published 2011.11.19, updated 2012.09.18, solved by 561 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p360
   * Scary Sphere
   * http://projecteuler.net/problem=360
   * published 2011.11.26, updated 2012.09.18, solved by 352 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p361
   * Subsequence of Thue-Morse sequence
   * http://projecteuler.net/problem=361
   * published 2011.12.03, updated 2012.09.18, solved by 132 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p362
   * Squarefree factors
   * http://projecteuler.net/problem=362
   * published 2011.12.11, updated 2012.09.18, solved by 249 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p363
   * B챕zier Curves
   * http://projecteuler.net/problem=363
   * published 2011.12.18, updated 2012.09.18, solved by 441 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p364
   * Comfortable distance
   * http://projecteuler.net/problem=364
   * published 2011.12.24, updated 2012.09.18, solved by 327 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p365
   * A huge binomial coefficient
   * http://projecteuler.net/problem=365
   * published 2011.12.31, updated 2012.09.18, solved by 434 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p366
   * Stone Game III
   * http://projecteuler.net/problem=366
   * published 2012.01.07, updated 2012.09.18, solved by 302 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p367
   * bozo sort
   * http://projecteuler.net/problem=367
   * published 2012.01.14, updated 2012.09.18, solved by 206 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p368
   * A Kempner-like series
   * http://projecteuler.net/problem=368
   * published 2012.01.21, updated 2012.09.18, solved by 304 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p369
   * Badugi
   * http://projecteuler.net/problem=369
   * published 2012.01.28, updated 2012.09.18, solved by 263 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p370
   * Geometric triangles
   * http://projecteuler.net/problem=370
   * published 2012.02.05, updated 2012.09.18, solved by 282 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p371
   * Licence plates
   * http://projecteuler.net/problem=371
   * published 2012.02.12, updated 2012.09.18, solved by 517 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p372
   * Pencils of rays
   * http://projecteuler.net/problem=372
   * published 2012.02.18, updated 2012.09.18, solved by 254 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p373
   * Circumscribed Circles
   * http://projecteuler.net/problem=373
   * published 2012.02.25, updated 2012.09.18, solved by 225 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p374
   * Maximum Integer Partition Product
   * http://projecteuler.net/problem=374
   * published 2012.03.03, updated 2012.09.18, solved by 309 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p375
   * Minimum of subsequences
   * http://projecteuler.net/problem=375
   * published 2012.03.10, updated 2012.09.18, solved by 360 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p376
   * Nontransitive sets of dice
   * http://projecteuler.net/problem=376
   * published 2012.03.17, updated 2012.09.18, solved by 164 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p377
   * Sum of digits, experience 13
   * http://projecteuler.net/problem=377
   * published 2012.03.25, updated 2012.09.18, solved by 297 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p378
   * Triangle Triples
   * http://projecteuler.net/problem=378
   * published 2012.04.01, updated 2012.09.18, solved by 320 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p379
   * Least common multiple count
   * http://projecteuler.net/problem=379
   * published 2012.04.08, updated 2012.09.18, solved by 224 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p380
   * Amazing Mazes!
   * http://projecteuler.net/problem=380
   * published 2012.04.14, updated 2012.09.18, solved by 259 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p381
   * (prime-k) factorial
   * http://projecteuler.net/problem=381
   * published 2012.04.21, updated 2012.09.18, solved by 993 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p382
   * Generating polygons
   * http://projecteuler.net/problem=382
   * published 2012.04.28, updated 2012.09.18, solved by 207 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p383
   * Divisibility comparison between factorials
   * http://projecteuler.net/problem=383
   * published 2012.05.05, updated 2012.09.18, solved by 257 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p384
   * Rudin-Shapiro sequence
   * http://projecteuler.net/problem=384
   * published 2012.05.12, updated 2012.09.18, solved by 211 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p385
   * Ellipses inside triangles
   * http://projecteuler.net/problem=385
   * published 2012.05.20, updated 2012.09.18, solved by 164 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p386
   * Maximum length of an antichain
   * http://projecteuler.net/problem=386
   * published 2012.05.27, updated 2012.09.18, solved by 307 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p387
   * Harshad Numbers
   * http://projecteuler.net/problem=387
   * published 2012.06.03, updated 2012.09.18, solved by 713 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p388
   * Distinct Lines
   * http://projecteuler.net/problem=388
   * published 2012.06.09, updated 2012.09.18, solved by 257 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p389
   * Platonic Dice
   * http://projecteuler.net/problem=389
   * published 2012.06.16, updated 2012.09.18, solved by 507 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p390
   * Triangles with non rational sides and integral area
   * http://projecteuler.net/problem=390
   * published 2012.06.23, updated 2012.09.18, solved by 323 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p391
   * Hopping Game
   * http://projecteuler.net/problem=391
   * published 2012.06.30, updated 2012.09.18, solved by 144 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p392
   * Enmeshed unit circle
   * http://projecteuler.net/problem=392
   * published 2012.09.01, updated 2012.09.18, solved by 233 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p393
   * Migrating ants
   * http://projecteuler.net/problem=393
   * published 2012.09.08, updated 2012.09.18, solved by 273 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p394
   * Eating pie
   * http://projecteuler.net/problem=394
   * published 2012.09.15, updated 2012.09.18, solved by 209 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p395
   * Pythagorean tree
   * http://projecteuler.net/problem=395
   * published 2012.09.22, updated 2012.09.23, solved by 254 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p396
   * Weak Goodstein sequence
   * http://projecteuler.net/problem=396
   * published 2012.09.29, updated 2012.09.27, solved by 213 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p397
   * Triangle on parabola
   * http://projecteuler.net/problem=397
   * published 2012.10.07, updated 2012.10.05, solved by 77 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p398
   * Cutting rope
   * http://projecteuler.net/problem=398
   * published 2012.10.14, updated 2012.10.13, solved by 133 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p399
   * Squarefree Fibonacci Numbers
   * http://projecteuler.net/problem=399
   * published 2012.10.21, updated 2012.10.24, solved by 167 people, solved by me=false
   * ***************************************************************************************************************
   */
  /**
   * **************************************************************************************************************
   * p400
   * Fibonacci tree game
   * http://projecteuler.net/problem=400
   * published 2012.10.27, updated 2012.10.27, solved by 77 people, solved by me=false
   * ***************************************************************************************************************
   */
  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  lazy val bigFibs = { // Fibonacci stream of BigInts
    def f(a: BigInt, b: BigInt): Stream[BigInt] = a #:: f(b, a + b)
    f(0, 1)
  }
  lazy val longFibs = { // Fibonacci stream of Longs
    def f(a: Long, b: Long): Stream[Long] = a #:: f(b, a + b)
    f(0, 1)
  }

  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  //1##Add all the natural numbers below one thousand that are multiples of 3 or 5.##1002301200##1347992365##247384##1
  //id, description/title, date_published (timestamp), date_last_updated (timestamp), solved_by (number of members), solved_flag (0=no / 1=yes)
  lazy val allProblems: List[String] = {
    val delimited: String = "***************************************************************************************************************"
    def parseDate(s: String): String = {
      val timeStamp: Long = s.toLong
      import java.util.Date
      import java.text.SimpleDateFormat
      val date: Date = new Date(timeStamp * 1000);
      val df = new SimpleDateFormat("yyyy.MM.dd");
      df.format(date)
    }
    def parseLine(s: String): String = {
      val fields: List[String] = s.split("##").toList
      val id: Int = fields(0).toInt
      val longUrl = "http://projecteuler.net/minimal=%d".format(id)
      //val detailed = Http(longUrl).param("q","monkeys").asString
      //val longDesc = Http(longUrl).option(HttpOptions.connTimeout(5000)).option(HttpOptions.readTimeout(25000)).asString
      val desc: String = fields(1)
      val datePublished = parseDate(fields(2))
      val dateUpdated = parseDate(fields(3))
      val solvedByN: Int = fields(4).toInt
      val solvedByMe: Boolean = fields(5).toInt > 0
      "/*%s\n * p%d\n * %s\n * %s\n * published %s, updated %s, solved by %d people, solved by me=%s\n *%s\n */"
        .format(delimited, id, desc, longUrl, datePublished, dateUpdated, solvedByN, solvedByMe, delimited)

    }
    val probList: List[String] = Euler.loadFile(List("euler", "allproblems.txt"))
    val max = probList.length
    val parsed = for (l <- probList) yield parseLine(l)
    parsed
  }
  //for (i <- 0 until 200) println(allProblems(i))
  //for (i <- 200 until 400) println(allProblems(i))
  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
}
object Euler {
  import java.io.File
  def subFile(file: File, children: String*) = {
    children.foldLeft(file)((file, child) => new File(file, child))
  }
  def resourceAsStreamFromSrc(resourcePath: List[String]): Option[java.io.InputStream] = {
    val classesDir = new File(getClass.getResource(".").toURI)
    val projectDir = classesDir.getParentFile.getParentFile.getParentFile.getParentFile
    val resourceFile = subFile(projectDir, ("src" :: "resources" :: resourcePath): _*)
    if (resourceFile.exists)
      Some(new java.io.FileInputStream(resourceFile))
    else
      None
  }
  def loadFile(filePath: List[String]): List[String] = {
    val wordstream = Option {
      getClass.getClassLoader.getResourceAsStream(filePath.mkString("/"))
    } orElse {
      resourceAsStreamFromSrc(filePath)
    } getOrElse {
      sys.error("file not found")
    }
    try {
      val s: scala.io.BufferedSource = io.Source.fromInputStream(wordstream)
      val lines: List[String] = s.getLines.toList
      lines
    } catch {
      case e: Exception =>
        println("Could not load file: " + e)
        throw e
    } finally {
      wordstream.close()
    }
  }
}